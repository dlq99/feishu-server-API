# ç¼–è¾‘æ—§ç‰ˆæ–‡æ¡£å†…å®¹



> **âš ï¸ è­¦å‘Š**
> æ­¤æ¥å£åªæ”¯æŒç¼–è¾‘æ—§ç‰ˆæ–‡æ¡£å†…å®¹ã€‚è¦ç¼–è¾‘æ–°ç‰ˆæ–‡æ¡£ï¼ˆæ–‡æ¡£ç±»å‹ï¼š`docx`ï¼‰çš„å†…å®¹ï¼Œè°ƒç”¨ä»¥ä¸‹æ¥å£ï¼š
> - åˆ›å»ºå—
> - æ›´æ–°å—
> - æ‰¹é‡æ›´æ–°å—
> - åˆ é™¤å—


è¯¥æ¥å£ç”¨äºæ‰¹é‡ç¼–è¾‘æ›´æ–°æ–‡æ¡£å†…å®¹ï¼ŒåŒ…æ‹¬æ›´æ–°æ ‡é¢˜ã€èŒƒå›´åˆ é™¤ã€æ’å…¥å†…å®¹ã€‚

## å‰ææ¡ä»¶

åœ¨ä½¿ç”¨æ­¤æ¥å£å‰ï¼Œè¯·ä»”ç»†é˜…è¯»æ–‡æ¡£æ¦‚è¿°å’Œå‡†å¤‡æ¥å…¥æ–‡æ¡£ APIäº†è§£æ–‡æ¡£è°ƒç”¨çš„è§„åˆ™å’Œçº¦æŸï¼Œç¡®ä¿ä½ çš„æ–‡æ¡£æ•°æ®ä¸ä¼šä¸¢å¤±æˆ–å‡ºé”™ã€‚ 
æ–‡æ¡£æ•°æ®ç»“æ„å®šä¹‰å¯å‚è€ƒï¼šæ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿°ã€‚

## è¯·æ±‚  
| åŸºæœ¬ |  |
| --- | --- |
| https://open.feishu.cn/open-apis/doc/v2/:docToken/batch_update |
| POST |
|  |
| æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶<br>æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†æ–‡æ¡£ |


### è¯·æ±‚å¤´
| åç§° | ç±»å‹ | å¿…å¡« | æè¿° |
| --- | --- | --- | --- |
| Authorization | string | æ˜¯ | `user_access_token` æˆ– `tenant_access_token`<br> <br>å€¼æ ¼å¼ï¼š"Bearer `access_token`"<br><br>ç¤ºä¾‹å€¼ï¼š"Bearer u-7f1bcd13fc57d46bac21793a18e560"<br> <br> äº†è§£æ›´å¤šï¼šå¦‚ä½•é€‰æ‹©ä¸è·å– access token |
| Content-Type | string | æ˜¯ | å›ºå®šå€¼ï¼š"application/json; charset=utf-8" |



::: note
å…³äºäº‘æ–‡æ¡£æ¥å£çš„ AccessToken è°ƒç”¨è¯´æ˜è¯¦è§ äº‘æ–‡æ¡£æ¥å£å¿«é€Ÿå…¥é—¨
:::
<br>
### è¯·æ±‚ä½“    
| å‚æ•°| ç±»å‹| å¿…é¡» | è¯´æ˜| 
| ------ | ------------ | ---- | -----|
|docToken|string|æ˜¯|æ–‡ä»¶çš„ tokenï¼Œè·å–æ–¹å¼è§å¦‚ä½•è·å–äº‘æ–‡æ¡£èµ„æºç›¸å…³ token|
| Revision      | int          | æ˜¯   | æ–‡æ¡£çš„æŒ‡å®šç‰ˆæœ¬ï¼Œæ–‡æ¡£æ–°åˆ›å»ºåç‰ˆæœ¬å·æ˜¯0ï¼Œè·å–æ–¹å¼ï¼Œè¦æ±‚>=0ï¼Œpost body json å­—æ®µ |
| Requests      | list<string> | æ˜¯   | post body jsonï¼Œ OperationRequest ç±»å‹åºåˆ—åŒ– string æ•°ç»„                         | 
  

#### OperationRequest

```
{
    "requestType": string,
    "updateTitleRequest": {object(UpdateTitleRequest)},
    "deleteContentRangeRequest": {object(DeleteContentRangeRequest)},
    "insertBlocksRequest": {object(InsertBlocksRequest)},
    "insertParagraphElementsRequest": {object(InsertParagraphElementsRequest)},
    "insertTableRowRequest": {object(InsertTableRowRequest)},
    "insertTableColumnRequest": {object(InsertTableColumnRequest)},
    "deleteTableRowsRequest": {object(DeleteTableRowsRequest)},
    "deleteTableColumnsRequest": {object(DeleteTableColumnsRequest)},
    "updateTableColumnPropertiesRequest": {object(UpdateTableColumnPropertiesRequest)},
    "mergeTableCellsRequest": {object(MergeTableCellsRequest)},
    "unmergeTableCellsRequest": {object(UnmergeTableCellsRequest)}
    "replaceAllTextRequest": {object{ReplaceAllTextRequest}}
    "updateParagraphStyleRequest": {object{UpdateParagraphStyleRequest}}
}
```

### å­—æ®µè¯´æ˜ 
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
| --- | --- | --- |
| requestType | string | OperationRequest: ä¼ å…¥ä¸‹æ–¹çš„ request å­—æ®µï¼ˆé¦–å­—æ¯éœ€è¦å¤§å†™ï¼‰ + 'Type'ï¼Œä¾‹å¦‚ 'UpdateTitleRequestType'ã€‚ <br> æ³¨æ„äº‹é¡¹ï¼ˆæœªæŒ‰ç…§æ ¼å¼æä¾›ä¼šæŠ¥é”™ï¼‰ <br> ==é¦–å­—æ¯éœ€è¦å¤§å†™== <br> ==æ·»åŠ  'Type'== |
| updateTitleRequest | object | æ›´æ–°æ ‡é¢˜ |
| deleteContentRangeRequest | object | èŒƒå›´åˆ é™¤ |
| insertBlocksRequest | object | æ’å…¥ blocks |
| insertParagraphElementsRequest | object | æ’å…¥è¡Œå†…å…ƒç´  |
| insertTableRowRequest | object | æ ¼å¼åŒ–è¡¨æ ¼å¢åŠ å•è¡Œ |
| insertTableColumnRequest | object | æ ¼å¼åŒ–è¡¨æ ¼å¢åŠ å•åˆ— |
| deleteTableRowsRequest | object | æ ¼å¼åŒ–è¡¨æ ¼åˆ é™¤å¤šè¡Œ |
| deleteTableColumnsRequest | object | æ ¼å¼åŒ–è¡¨æ ¼åˆ é™¤å¤šåˆ— |
| updateTableColumnPropertiesRequest | object | æ ¼å¼åŒ–è¡¨æ ¼ä¿®æ”¹åˆ—å®½åº¦ |
| mergeTableCellsRequest | object | æ ¼å¼åŒ–è¡¨æ ¼åˆå¹¶å•å…ƒæ ¼ |
| unmergeTableCellsRequest | object | æ ¼å¼åŒ–è¡¨æ ¼æ‹†åˆ†å•å…ƒæ ¼ |
| ReplaceAllTextRequest | object | æŸ¥æ‰¾æ›¿æ¢æ–‡æœ¬å†…å®¹ |
| UpdateParagraphStyleRequest | object | æ›´æ–°æ®µè½æ ·å¼ |


     

### InsertLocation

```json
{
    "zoneId": string,
    "index": int,
    "startOfZone": bool,
    "endOfZone": bool
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ   | ç±»å‹   | è¯´æ˜                                                         |
| ------ | ------ | ------------------------------------------------------------ |
| zoneId | string | ç¼–è¾‘åŒºåŸŸï¼ŒåŒ…æ‹¬ä¸¤ç§ï¼Œæ­£æ–‡æ˜¯ "0"ï¼Œè¡¨æ ¼å•å…ƒæ ¼ IDï¼Œä¾‹å¦‚ "xr1m4jw7egd9nefz1s0mdsetenl5fbe3lygxc1azupv81i5t2rjmosw5ta0esuwtn8ksya" |
| index  | int    | å­—ç¬¦ä¸‹æ ‡ï¼Œæ ‡é¢˜å ç”¨ç´¢å¼•ï¼Œä» 0 å¼€å§‹                            |
| startOfZone  | bool    | InsertBlocksRequestTypeæ”¯æŒä¾¿æ·æ“ä½œï¼Œæ’å…¥zoneå¼€å§‹ä½ç½®ï¼Œæ­£æ–‡å¤´éƒ¨ï¼ˆä¸ç®—æ ‡é¢˜ï¼‰æˆ–å•å…ƒæ ¼èµ·å§‹ä½ç½®ã€‚trueæ—¶indexå…¥å‚æ— æ•ˆ                            |
 | endOfZone  | bool    | InsertBlocksRequestTypeæ”¯æŒä¾¿æ·æ“ä½œï¼Œæ’å…¥zoneå°¾éƒ¨ï¼Œæ­£æ–‡å°¾éƒ¨æˆ–å•å…ƒæ ¼å°¾éƒ¨ã€‚trueæ—¶indexå…¥å‚æ— æ•ˆ                            |
  
### Range

èŒƒå›´åˆ é™¤ç»“æ„ï¼Œåˆ é™¤èŒƒå›´ [StartIndex, EndIndex)

```json
{
   "zoneId": string,
   "startIndex": int,
   "endIndex": int
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ       | ç±»å‹   | è¯´æ˜                                                         |
| ---------- | ------ | ------------------------------------------------------------ |
| zoneId     | string | ç¼–è¾‘åŒºåŸŸï¼ŒåŒ…æ‹¬ä¸¤ç§ï¼Œæ­£æ–‡æ˜¯ "0"ï¼Œè¡¨æ ¼å•å…ƒæ ¼ IDï¼Œä¾‹å¦‚ "xr1m4jw7egd9nefz1s0mdsetenl5fbe3lygxc1azupv81i5t2rjmosw5ta0esuwtn8ksya" |
| startIndex | int    | åˆ é™¤èµ·å§‹ä½ç½®                                                 |
| endIndex   | int    | åˆ é™¤ç»“æŸä½ç½®                                                 |

### UpdateTitleRequest

```json
{
    "payload": string
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ    | ç±»å‹   | è¯´æ˜                                                         |
| ------- | ------ | ------------------------------------------------------------ |
| payload | string | æ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿° Titleç»“æ„ä½“åºåˆ—åŒ– string |
  
**è¯·æ±‚ç¤ºä¾‹**
   

> **ğŸ“ æ³¨æ„**
> æœ¬ç¤ºä¾‹å°†ä¼šæŠŠæ–‡æ¡£çš„æ ‡é¢˜ä¿®æ”¹ä¸º Updated Document Title


  ```
{
    "Revision": 1,
    "Requests": [
        "{\"requestType\":\"UpdateTitleRequestType\",\"updateTitleRequest\":{\"payload\":\"{\\\"elements\\\":[{\\\"type\\\":\\\"textRun\\\",\\\"textRun\\\":{\\\"text\\\":\\\"Updated Document Title\\\",\\\"style\\\":{}}}],\\\"style\\\":{}}\"}}"
    ]
}
  ```

### DeleteContentRangeRequest

```json
{
    "deleteRange": {object(Range)}
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ        | ç±»å‹   | è¯´æ˜     |
| ----------- | ------ | -------- |
| deleteRange | object | åˆ é™¤èŒƒå›´ |
  
  **è¯·æ±‚ç¤ºä¾‹**
  

> **ğŸ“ æ³¨æ„**
> æœ¬ç¤ºä¾‹å°†ä¼šåœ¨æ–‡æ¡£ä¸­åˆ é™¤é€‰å®šèŒƒå›´çš„å†…å®¹


  ```
  {
    "Revision": 1,
    "Requests": [
        "{\"requestType\":\"DeleteContentRangeRequestType\",\"deleteContentRangeRequest\":{\"deleteRange\":{\"zoneId\":\"0\",\"startIndex\":625,\"endIndex\":631}}}"
    ]
}    
  ```

### InsertBlocksRequest
æ”¯æŒè¿”å›æ®µè½æ–‡æœ¬ä¸­çš„lineId

```json
{
    "payload": string,
    "location": {object(InsertLocation)}
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ     | ç±»å‹   | è¯´æ˜                                                         |
| -------- | ------ | ------------------------------------------------------------ |
| payload  | string | æ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿° Bodyç»“æ„ä½“åºåˆ—åŒ–string |
| location | object | æ’å…¥ä½ç½®                                                     |
  **è¯·æ±‚ç¤ºä¾‹**  
  

> **ğŸ“ æ³¨æ„**
> æœ¬ç¤ºä¾‹å°†ä¼šåœ¨æ–‡æ¡£ä¸­æ’å…¥ä¸€è¡Œæ–‡æœ¬ã€ä¸€ä¸ª 3x3 çš„æ™®é€šè¡¨æ ¼å’Œä¸€ä¸ª 3x3 çš„ç”µå­è¡¨æ ¼


  ```
  {
    "Revision": 1,
    "Requests": [
        "{\"requestType\":\"InsertBlocksRequestType\",\"insertBlocksRequest\":{\"payload\":\"{\\\"blocks\\\":[{\\\"type\\\":\\\"paragraph\\\",\\\"paragraph\\\":{\\\"elements\\\":[{\\\"type\\\":\\\"textRun\\\",\\\"textRun\\\":{\\\"text\\\":\\\"Docs API Sample Content\\\",\\\"style\\\":{}}}],\\\"style\\\":{}}},{\\\"type\\\":\\\"table\\\",\\\"table\\\":{\\\"rowSize\\\":3, \\\"columnSize\\\":3}},{\\\"type\\\":\\\"sheet\\\",\\\"sheet\\\":{\\\"rowSize\\\":3, \\\"columnSize\\\":3}}]}\",\"location\":{\"zoneId\":\"0\",\"index\":0, \"endOfZone\": true}}}"
    ]
}
  ```

### InsertParagraphElementsRequest

```json
{
    "payload": string,
    "location": {object(InsertLocation)}
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ     | ç±»å‹   | è¯´æ˜                                                         |
| -------- | ------ | ------------------------------------------------------------ |
| payload  | string |ä¼ å…¥ç¬¦åˆæ–‡æ¡£æ•°æ®ç»“æ„çš„å­—ç¬¦ä¸² |
| location | object | æ’å…¥ä½ç½®                                                     |
  
 **è¯·æ±‚ç¤ºä¾‹**



> **ğŸ“ æ³¨æ„**
> æœ¬ç¤ºä¾‹å°†ä¼šåœ¨ä¸€æ®µæ–‡æœ¬ä¸­æ’å…¥ä¸€æ®µè¡Œå†…ä»£ç  `Docs API Sample Content`


  ```
  {
    "Revision": 1,
    "Requests": [
        "{\"requestType\":\"InsertParagraphElementsRequestType\",\"insertParagraphElementsRequest\":{\"payload\":\"{\\\"elements\\\":[{\\\"type\\\":\\\"textRun\\\",\\\"textRun\\\":{\\\"text\\\":\\\"Docs API Sample Content\\\",\\\"style\\\":{\\\"codeInline\\\":true}}}],\\\"style\\\":{}}\",\"location\":{\"zoneId\":\"0\",\"index\":653}}}"
    ]
}
  ```
### InsertTableRowRequest

```json
{
    "tableId": string,
    "rowIndex": int
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ     | ç±»å‹   | è¯´æ˜                                                         |
| -------- | ------ | ------------------------------------------------------------ |
| tableId  | string | è¡¨æ ¼ id, è¯¦è§ æ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿° Table ç»“æ„ä½“å®šä¹‰ |
| rowIndex | object | æ’å…¥è¡Œç´¢å¼•ï¼Œä» 0 å¼€å§‹ï¼Œå¾€ç¬¬ä¸€è¡Œå‰æ’å…¥ä½¿ç”¨ 0                  |
  
  **è¯·æ±‚ç¤ºä¾‹**
  ::: note
  æœ¬ç¤ºä¾‹å°†ä¼šåœ¨ä¸€ä¸ªè¡¨æ ¼çš„ç¬¬ä¸€è¡Œä¸Šæ–¹å†æ’å…¥ä¸€è¡Œ
  :::
  ```
  {
        "Revision": 167,
        "Requests": [
        "{\"requestType\":\"InsertTableRowRequestType\",\"insertTableRowRequest\":{\"tableId\":\"rslqdc8170vgu2vsjj2544fwz54ybb3hz7-csc9cbethbmi129ukq31cko24r28wziaa6\", \"rowIndex\": 0}}"
        ]
}
  ```

  
### InsertTableColumnRequest

```json
{
    "tableId": string,
    "columnIndex": int
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ        | ç±»å‹   | è¯´æ˜                                                         |
| ----------- | ------ | ------------------------------------------------------------ |
| tableId     | string | è¡¨æ ¼id, è¯¦è§ æ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿° Table ç»“æ„ä½“å®šä¹‰ |
| columnIndex | object | æ’å…¥åˆ—ç´¢å¼•ï¼Œä» 0 å¼€å§‹ï¼Œå¾€ç¬¬ä¸€åˆ—å‰æ’å…¥ä½¿ç”¨ 0                  |
  **è¯·æ±‚ç¤ºä¾‹**
  ::: note
  æœ¬ç¤ºä¾‹å°†ä¼šåœ¨ä¸€ä¸ªè¡¨æ ¼çš„ç¬¬äºŒåˆ—å·¦ä¾§å†æ’å…¥ä¸€åˆ—
  :::
  ```
  {
        "Revision": 178,
        "Requests": [
        "{\"requestType\":\"InsertTableColumnRequestType\",\"insertTableColumnRequest\":{\"tableId\":\"rslqdc8170vgu2vsjj2544fwz54ybb3hz7-csc9cbethbmi129ukq31cko24r28wziaa6\", \"columnIndex\": 1}}"
        ]
}
  ```

### DeleteTableRowsRequest

åˆ é™¤å¤šè¡Œï¼Œåˆ é™¤èŒƒå›´ [RowStartIndex,RowEndIndex)

```json
{
    "tableId": string,
    "rowStartIndex": int,
    "rowEndIndex": int
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ          | ç±»å‹   | è¯´æ˜                                                         |
| ------------- | ------ | ------------------------------------------------------------ |
| tableId       | string | è¡¨æ ¼id, è¯¦è§ æ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿° Tableç»“æ„ä½“å®šä¹‰ |
| rowStartIndex | int    | åˆ é™¤è¡Œèµ·å§‹ç´¢å¼•ï¼Œä» 0 å¼€å§‹                                    |
| rowEndIndex   | int    | åˆ é™¤è¡Œç»“æŸç´¢å¼•                                               |

   **è¯·æ±‚ç¤ºä¾‹**
  ::: note
  æœ¬ç¤ºä¾‹å°†ä¼šåˆ é™¤é€‰å®šè¡¨æ ¼çš„ç¬¬ä¸€è¡Œ
  :::
  ```
  {
        "Revision": 197,
        "Requests": [
        "{\"requestType\":\"DeleteTableRowsRequestType\",\"deleteTableRowsRequest\":{\"tableId\":\"rslqdc8170vgu2vsjj2544fwz54ybb3hz7-csc9cbethbmi129ukq31cko24r28wziaa6\", \"rowStartIndex\": 0, \"rowEndIndex\": 1}}"
        ]
}
  ```

### DeleteTableColumnsRequest

åˆ é™¤å¤šåˆ—ï¼Œåˆ é™¤èŒƒå›´ [ColumnStartIndex,ColumnEndIndex)

```json
{
    "tableId": string,
    "columnStartIndex": int,
    "columnEndIndex": int
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ             | ç±»å‹   | è¯´æ˜                                                         |
| ---------------- | ------ | ------------------------------------------------------------ |
| tableId          | string | è¡¨æ ¼id, è¯¦è§ æ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿° Tableç»“æ„ä½“å®šä¹‰ |
| columnStartIndex | int    | åˆ é™¤åˆ—èµ·å§‹ç´¢å¼•ï¼Œä» 0 å¼€å§‹                                    |
| columnEndIndex   | int    | åˆ é™¤åˆ—ç»“æŸç´¢å¼•                                               |
  
**è¯·æ±‚ç¤ºä¾‹**
  ::: note
  æœ¬ç¤ºä¾‹å°†ä¼šåˆ é™¤é€‰å®šè¡¨æ ¼çš„ç¬¬äºŒåˆ—å’Œç¬¬ä¸‰åˆ—
  :::
  ```
  {
        "Revision": 197,
        "Requests": [
        "{\"requestType\":\"DeleteTableColumnsRequestType\",\"deleteTableColumnsRequest\":{\"tableId\":\"rslqdc8170vgu2vsjj2544fwz54ybb3hz7-csc9cbethbmi129ukq31cko24r28wziaa6\", \"columnStartIndex\": 1, \"columnEndIndex\": 3}}"
        ]
}
  ```
  
  

### UpdateTableColumnPropertiesRequest

```json
{
  "tableId": string,
  "columnIndex": int,
  "columnWidth": int
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ        | ç±»å‹   | è¯´æ˜                                                         |
| ----------- | ------ | ------------------------------------------------------------ |
| tableId     | string | è¡¨æ ¼id, è¯¦è§ æ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿° Tableç»“æ„ä½“å®šä¹‰ |
| columnIndex | int    | åˆ—ç´¢å¼•ï¼Œä» 0 å¼€å§‹                                            |
| columnWidth | int    | åˆ—å®½åº¦ï¼Œå•ä½ px                                              |

**è¯·æ±‚ç¤ºä¾‹**
  ::: note
  æœ¬ç¤ºä¾‹å°†ä¼šæŠŠé€‰å®šè¡¨æ ¼çš„ç¬¬äºŒåˆ—åˆ—å®½è°ƒæ•´ä¸º 200
  :::
  
  ```
  {
        "Revision": 212,
        "Requests": [
        "{\"requestType\":\"UpdateTableColumnPropertiesRequestType\",\"updateTableColumnPropertiesRequest\":{\"tableId\":\"rslqdc8170vgu2vsjj2544fwz54ybb3hz7-csc9cbethbmi129ukq31cko24r28wziaa6\", \"columnIndex\": 1, \"columnWidth\": 200}}"
        ]
}
  ```

### MergeTableCellsRequest

```json
{
  "tableId": string,
  "rowStartIndex": int,
  "rowEndIndex": int,
  "columnStartIndex": int,
  "columnEndIndex": int,
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ             | ç±»å‹   | è¯´æ˜                                                         |
| ---------------- | ------ | ------------------------------------------------------------ |
| tableId          | string | è¡¨æ ¼ id, è¯¦è§ æ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿° Table ç»“æ„ä½“å®šä¹‰ |
| rowStartIndex    | int    | åˆå¹¶è¡Œèµ·å§‹ç´¢å¼•ï¼Œä» 0 å¼€å§‹                                    |
| rowEndIndex      | int    | åˆå¹¶è¡Œç»“æŸç´¢å¼•                                               |
| columnStartIndex | int    | åˆå¹¶åˆ—èµ·å§‹ç´¢å¼•ï¼Œä» 0 å¼€å§‹                                    |
| columnEndIndex   | int    | åˆå¹¶åˆ—ç»“æŸç´¢å¼•                                               |

  **è¯·æ±‚ç¤ºä¾‹**
  ::: note
  æœ¬ç¤ºä¾‹å°†ä¼šåˆå¹¶é€‰å®šè¡¨æ ¼å·¦ä¸Šæ–¹çš„ 4 ä¸ªå•å…ƒæ ¼
  :::
  ```
  {
        "Revision": 237,
        "Requests": [
        "{\"requestType\":\"MergeTableCellsRequestType\",\"mergeTableCellsRequest\":{\"tableId\":\"rslqdc8170vgu2vsjj2544fwz54ybb3hz7-csc9cbethbmi129ukq31cko24r28wziaa6\", \"rowStartIndex\": 0, \"rowEndIndex\": 2,\"columnStartIndex\": 0, \"columnEndIndex\": 2}}"
        ]
}
  ```
  
### UnmergeTableCellsRequest

```json
{
  "tableId": string,
  "mergedCellId": string
}
```

**å­—æ®µè¯´æ˜** :  <br>

| å­—æ®µ         | ç±»å‹   | è¯´æ˜                                                         |
| ------------ | ------ | ------------------------------------------------------------ |
| tableId      | string | è¡¨æ ¼ id, è¯¦è§ æ–‡æ¡£æ•°æ®ç»“æ„æ¦‚è¿° Tableç»“æ„ä½“å®šä¹‰ |
| mergedCellId | string | åˆå¹¶å•å…ƒæ ¼ id                                                |
  
  **è¯·æ±‚ç¤ºä¾‹**
  ::: note
  æœ¬ç¤ºä¾‹å°†ä¼šæ‹†åˆ†è¡¨æ ¼å·¦ä¸Šæ–¹åˆå¹¶çš„ 4 ä¸ªå•å…ƒæ ¼
  :::
  ```
  {
        "Revision": 253,
        "Requests": [
        "{\"requestType\":\"UnmergeTableCellsRequestType\",\"unmergeTableCellsRequest\":{\"tableId\":\"rslqdc8170vgu2vsjj2544fwz54ybb3hz7-csc9cbethbmi129ukq31cko24r28wziaa6\", \"mergedCellId\": \"iskfju5o\"}}"
        ]
}
  ```
  
### ReplaceAllTextRequest
|å­—æ®µ|ç±»å‹|å¿…é¡»|è¯´æ˜|
|---|---|---|---|
|replaceText|string |æ˜¯|æ›¿æ¢æ–‡å­—ï¼Œå¯ä¸ºç©ºï¼Œä¸å¯åŒ…å«æ¢è¡Œç¬¦ã€tabï¼Œæœ€å¤š1000ä¸ªå­—|
|containsText|SubstringMatchCriteria|æ˜¯|æŸ¥æ‰¾æ–‡å­—|

**SubstringMatchCriteria**  
|å­—æ®µ|ç±»å‹|å¿…é¡»|è¯´æ˜|
|---|---|---|---|
|text|string |æ˜¯|æŸ¥æ‰¾å†…å®¹ï¼Œä¸å¯ä¸ºç©ºï¼Œä¸å¯åŒ…å«æ¢è¡Œã€tabï¼Œæœ€å¤š1000ä¸ªå­—|
|matchCase|bool|å¦|æ˜¯å¦åŒ¹é…å¤§å°å†™ï¼Œé»˜è®¤falseï¼Œå¿½ç•¥å¤§å°å†™|
  
  **è¯·æ±‚ç¤ºä¾‹**
  ::: note
  æœ¬ç¤ºä¾‹å°†ä¼šæŠŠæ–‡æ¡£ä¸­çš„â€œAPIâ€å­—æ®µæ›¿æ¢ä¸ºâ€œTestâ€
  :::
  ```
  {
        "Revision": 269,
        "Requests": [
        "{\"requestType\":\"ReplaceAllTextRequestType\",\"replaceAllTextRequest\":{\"containsText\":{\"text\":\"API\",\"matchCase\":false},\"replaceText\": \"Test\"}}"
        ]
}
  ```

### UpdateParagraphStyleRequest
|å­—æ®µ|ç±»å‹|å¿…é¡»|è¯´æ˜|
|---|---|---|---|
|payload|string |æ˜¯|è¯¦è§æ–‡æ¡£æ•°æ®ç»“æ„å‚è€ƒ<br>UpdateParagraphStyleRequest å­å‘½ä»¤ä½¿ç”¨ ParagraphStyle ç»“æ„ä½“åºåˆ—åŒ– string|
|range|Range|æ˜¯|ä¿®æ”¹èŒƒå›´|
|fields|FieldMask|æ˜¯|ä¿®æ”¹å­—æ®µ|

**FieldMask**
|å­—æ®µ|ç±»å‹|å¿…é¡»|è¯´æ˜|
|---|---|---|---|
|masks|[]string |æ˜¯|ä¿®æ”¹å­—æ®µï¼ŒåŒ…æ‹¬"list"ã€"headingLevel"ã€"align"ã€"quote"|
  **è¯·æ±‚ç¤ºä¾‹**
  ::: note
  æœ¬ç¤ºä¾‹å°†ä¼šæŠŠæ–‡æ¡£ä¸­ TODO å˜ä¸ºå®ŒæˆçŠ¶æ€
  :::
  ```
  {
        "Revision": 312,
        "Requests": ["{\"RequestType\":\"UpdateParagraphStyleRequestType\",\"updateParagraphStyleRequest\":{\"payload\":\"{\\\"list\\\":{\\\"type\\\":\\\"checkedBox\\\",\\\"indentLevel\\\":1}}\",\"range\":{\"zoneID\":\"0\",\"startIndex\":667,\"endIndex\":678},\"fields\":{\"masks\":[\"list\"]}}}"]
}
  ```
  
### è¿”å› Bodyï¼š  

```json
  {
    "code": 0,
    "msg": "Success",
    "data": {}
}
```
### é”™è¯¯ç 

å…·ä½“å¯å‚è€ƒï¼šæœåŠ¡ç«¯é”™è¯¯ç è¯´æ˜  

### batch_update æ“ä½œå¸®åŠ©
å¯¹äº batch_update æ“ä½œï¼Œéœ€è¦å…³æ³¨ä»¥ä¸‹æ³¨æ„äº‹é¡¹ï¼š
1. è¯·æ±‚æ—¶ï¼Œå¿…é¡»å¸¦ä¸Šæ­£ç¡®çš„ revision ç‰ˆæœ¬å·ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´æ•°æ®é”™ä¹±ã€‚æ­¤å¤–ï¼Œå¯¹äºä¸€ç¯‡åä½œæ–‡æ¡£ï¼Œrevision ç‰ˆæœ¬å·æ˜¯æœ‰æ—¶æ•ˆæ€§éªŒè¯çš„ï¼Œæˆ‘ä»¬å»ºè®®æ¯æ¬¡æ›´æ–°æ–‡æ¡£æ—¶ï¼Œéƒ½ä½¿ç”¨æœ€æ–°çš„ revision ç‰ˆæœ¬å·ï¼Œä½¿ç”¨ä¸€ä¸ªè¿‡æ—§çš„ revision ç‰ˆæœ¬å·ä¼šå¯¼è‡´æ¥å£æŠ¥é”™ã€‚
2. å•æ¬¡è¯·æ±‚ä¸­ï¼Œéƒ¨åˆ†å…ƒç´ æœ‰ä¸ªæ•°é™åˆ¶ï¼š
	- è¯·æ±‚requests sizeæœ€å¤§10ä¸ª
  	- å•ä¸ªinsertæ“ä½œä¸­person æ•°æœ€å¤§100
	- å•ä¸ªinsertæ“ä½œä¸­docsLinkæ•°æœ€å¤§100
  	- å•ä¸ªinsertæ“ä½œä¸­chatGroupæ•°æœ€å¤§5
	- å•ä¸ªinsertæ“ä½œä¸­blockæ•°é‡ï¼ˆå«jiraï¼ŒæŠ•ç¥¨ã€ç»˜å›¾ã€sheetã€bitableï¼‰æœ€å¤§50
	- å•ä¸ªinsertæ“ä½œå•è¡Œå›¾ç‰‡æœ€å¤š6ä¸ª
	- å•ä¸ªinsertæ“ä½œå›¾ç‰‡å’Œé™„ä»¶æ•°é‡æœ€å¤š50ä¸ª
	- UpdateTitleRequestTypeæœ€å¤šå‡ºç°ä¸€æ¬¡
	- UpdateParagraphStyleRequestã€ReplaceAllTextRequestTypeã€DeleteTableRowsRequestTypeã€DeleteTableColumnsRequestTypeè¿™å‡ ç§å­å‘½ä»¤ä¸å¯å’Œå…¶ä»–å‘½ä»¤å…±å­˜
3. æ’å…¥ã€åˆ é™¤æ“ä½œå¯¹Indexè¦æ±‚
	- DeleteContentRangeRequestTypeå­å‘½ä»¤
		1. æ”¯æŒä¸¤ç§æ“ä½œï¼šï¼ˆ1ï¼‰åˆ é™¤è¿ç»­blocksï¼ˆåˆ é™¤æ¢è¡Œç¬¦ï¼Œæœ€åä¸€ä¸ªblockçš„æ¢è¡Œç¬¦å¯é€‰ï¼‰ï¼ˆ2ï¼‰è¿ç»­è¡Œå†…å…ƒç´ ï¼ˆä¸åˆ é™¤æ¢è¡Œç¬¦ï¼‰ã€‚
    	2. blockå’Œelementåˆ é™¤å¿…é¡»å®Œæ•´
	    3. å®é™…åˆ é™¤åŒºé—´å·¦é—­å³å¼€[startIndex, endIndex)
    	4. endIndexå¯ä»¥ä½¿ç”¨æ–‡æ¡£æœ€åä¸€ä¸ªæ¢è¡Œç¬¦ä½ç½®ï¼Œä½†æ˜¯ä¼šä¿ç•™
    	5. å¯¹äºåˆ é™¤blockï¼ŒendIndexå¯ä»¥åŒ…æ‹¬æœ€åä¸€ä¸ªblockçš„æ¢è¡Œç¬¦ï¼ˆ+1ï¼‰ä¹Ÿå¯ä»¥ä¸åŒ…å«ï¼ŒåŒ…å«çš„è¯ä¼šåˆ é™¤æ”¹æ¢è¡Œç¬¦
	- InsertBlocksRequestTypeå­å‘½ä»¤
    	1. è¦æ±‚åªèƒ½åœ¨æ–°è¡Œæ’å…¥ï¼Œå³æ’å…¥ä½ç½®å‰ä¸€ä¸ªå­—ç¬¦ä¸ºæ¢è¡Œç¬¦ã€‚å®é™…æ’å…¥ä½ç½®ä»Indexå¼€å§‹ã€‚Indexå¯ä»¥ç­‰äºæœ€åä¸€ä¸ªæ¢è¡Œç¬¦ï¼ˆdocLengh-1ï¼‰ï¼Œä¸å¯ä»¥å¤§äºæˆ–ç­‰äºdocLengh
	-  InsertParagraphElementsRequestTypeå­å‘½ä»¤
    	1. è¦æ±‚æ’å…¥ä½ç½®ä¸å¯åœ¨è¡Œå†…å…ƒç´ ä¸­é—´ï¼Œå¯ä»¥æ’å…¥è¡Œå†…æŸå…ƒç´ ä¹‹å‰æˆ–è€…ä¹‹åã€‚æ”¯æŒç©ºè¡Œæˆ–è€…ä»…æœ‰ä¸€ä¸ªè¡Œå±æ€§çš„è¡Œï¼Œå®é™…æ’å…¥ä½ç½®ä»Indexå¼€å§‹ï¼ŒIndexä¸å¯ç­‰äºæœ€åä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œå¦åˆ™æ–‡æ¡£æœ«å°¾åªæœ‰ä¸€ä¸ªæ¢è¡Œç¬¦
    	2. è‹¥è¡Œé¦–å­˜åœ¨å ä½ç¬¦ï¼ˆstyleï¼‰ï¼ŒInsertParagraphElementsRequestTypeå­å‘½ä»¤çš„startIndexä¸å¯ä»¥ç­‰äºè¯¥å ä½ç¬¦ï¼ˆparagraphStyleå¦‚æœå­˜åœ¨è¡Œé¦–ä¼šæœ‰ä¸€ä¸ªå ä½ç¬¦ï¼‰
	- æ‰¹é‡æ“ä½œèŒƒå›´ä¸å¯é‡å¤
    	1. ä¸¤ä¸ªDeleteContentRangeRequestTypeæ“ä½œ d1å’Œd2ï¼ŒèŒƒå›´ä¸å¯é‡å¤ï¼Œå‡è®¾d2.StartIndex>=d1.StartIndexï¼Œè¦æ±‚d2.StartIndex>=d1.EndIndex
    	2. ä¸€ä¸ªDeleteContentRangeRequestType då’Œä¸€ä¸ªInsertæ“ä½œiï¼ˆä¸¤ç§ä»»ä¸€ï¼‰èŒƒå›´ä¸å¯é‡å¤ï¼Œå‡è®¾ i.Index >= d.StartIndexï¼Œè¦æ±‚i.Index >=d.StartIndexæˆ–i.Index == d.StartIndex
	- UpdateParagraphStyleRequestå­å‘½ä»¤
		1. rangeçš„startIndexå¿…é¡»ç­‰äºæŸä¸ªblockçš„startIndexï¼Œrangeçš„endIndexå¿…é¡»ç­‰äºæŸä¸ªblockçš„endIndex
4. æƒé™æ ¡éªŒ
 	- docsLinké“¾æ¥å¦‚æœæ²¡æœ‰æƒé™ï¼Œä¼šé™çº§ä¸ºè¶…é“¾æ¥; å¦‚æœæ–‡æ¡£æœªå‘½åï¼Œé™çº§ä¸ºè¶…é“¾æ¥
	- personå¦‚æœæ²¡æœ‰æƒé™ï¼ˆéåŒç§Ÿæˆ·ä¸”éå¥½å‹ï¼‰ï¼Œè¿”å›é”™è¯¯ï¼›å¦‚æœå·²ç¦»èŒï¼Œè¿”å›é”™è¯¯
	- æ’å…¥chatGroupå¦‚æœç¼–è¾‘ç”¨æˆ·ä¸åœ¨è¯¥ç¾¤ä¼šè¯ä¸­ï¼Œè¿”å›é”™è¯¯
5. æ ¼å¼åŒ–è¡¨æ ¼å’Œä»£ç å—
	- ä¸€æ¬¡batch_updateå•ä¸ªtableåªå…è®¸ä¸€ä¸ªè¡¨æ ¼ç»“æ„ä¿®æ”¹æ“ä½œï¼ˆå¢åˆ è¡Œåˆ—ã€åˆ—å±æ€§ä¿®æ”¹ã€åˆå¹¶å•å…ƒæ ¼ã€æ‹†åˆ†å•å…ƒæ ¼ï¼‰
	- å¢åŠ è¡Œåˆ—åªèƒ½å•ä¸ªï¼Œåˆ é™¤è¡Œåˆ—æ”¯æŒèŒƒå›´åˆ é™¤
	- åˆ é™¤è¡Œåˆ—ä¼šæ¸…ç©ºå½±å“çš„å•å…ƒæ ¼ï¼Œåˆ é™¤å…¨éƒ¨è¡Œæˆ–åˆ—ä¼šå¯¼è‡´åˆ é™¤æ•´ä¸ªè¡¨æ ¼ï¼›å› æ­¤å’Œæ’å…¥blockã€æ’å…¥è¡Œå†…å…ƒç´ ã€èŒƒå›´åˆ é™¤ä¸€èµ·æ’åºåè¿›è¡Œï¼Œéœ€è¦ä¿è¯å¤šä¸ªæ“ä½œèŒƒå›´ä¸å†²çª
	- å•å…ƒæ ¼å†…å®¹ç¼–è¾‘ä½¿ç”¨DeleteContentRangeRequestTypeã€InsertBlocksRequestTypeå’ŒInsertParagraphElementsRequestTypeï¼Œåªæ˜¯zoneIdä½¿ç”¨å•å…ƒæ ¼çš„zoneIdï¼Œæ¯”å¦‚xr1m4jw7egd9nefz1s0mdsetenl5fbe3lygxc1azupv81i5t2rjmosw5ta0esuwtn8ksya
	- è¡¨æ ¼ä¸­ä¸èƒ½åµŒå¥—tableã€sheetã€bitable
	- ç›¸åŒå•å…ƒæ ¼merge/unmergeæ“ä½œå’Œå•å…ƒæ ¼ç¼–è¾‘æ“ä½œä¸å¯å…±å­˜
	- ç›¸åŒå•å…ƒæ ¼ deleteè¡Œåˆ—æ“ä½œå’Œå•å…ƒæ ¼ç¼–è¾‘æ“ä½œä¸å¯å…±å­˜
	- åˆ é™¤è¡¨æ ¼å’Œç¼–è¾‘å•å…ƒæ ¼å†…å®¹æ“ä½œä¸å¯å…±å­˜
	- åˆ é™¤è¡¨æ ¼å’Œä¿®æ”¹è¡¨æ ¼ç»“æ„æ“ä½œä¸å¯å…±å­˜
	- åˆ é™¤code zoneå’Œç¼–è¾‘code zoneå†…å®¹æ“ä½œä¸å¯å…±å­˜
  
### é”™è¯¯ç 
| é”™è¯¯ç  | è¯´æ˜ | æ’æŸ¥å»ºè®® |
| --- | --- | --- |
| 91401 | PARAMERR | å‚æ•°å‡ºç°é”™è¯¯ï¼Œæ£€æŸ¥å‚æ•°æœ‰æ•ˆæ€§ |
| 91402 | NOTEXIST | æœªæ‰¾åˆ°ï¼Œæ£€æŸ¥tokenæ˜¯å¦æœ‰æ•ˆ |
| 91403 | FORBIDDEN | æ²¡æœ‰æƒé™ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰æ–‡æ¡£è¯»æƒé™ |
| 91404 | LOGIN_REQUIRED | éœ€è¦ç™»å½• |
| 95001 | internal error | å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯• |
| 95003 | internal error | å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯• |
| 95005 | internal error | å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯• |
| 95006 | Failed | æ–‡æ¡£æœªæ‰¾åˆ°ï¼Œæ£€æŸ¥tokenæ˜¯å¦æœ‰æ•ˆ |
| 95007 | Failed | æ–‡æ¡£å·²åˆ é™¤ï¼Œå·²åˆ é™¤æ–‡ä»¶æ— æ³•è·å–æ–‡æ¡£metaä¿¡æ¯ |
| 95008 | FORBIDDEN | æ£€æŸ¥ç”¨æˆ·å¯¹æ–‡æ¡£ã€æ–‡ä»¶å¤¹çš„æƒé™ |
| 95009 | Failed | æ²¡æœ‰æƒé™ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰æ–‡æ¡£è¯»æƒé™ã€‚æ·»åŠ æ–‡æ¡£æƒé™ |
| 95010 | internal error | å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯• |
| 95011 | internal error | å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯• |
| 95017 | å…·ä½“é”™è¯¯ä¿¡æ¯ | è¯»å–æ–‡æ¡£å†…å®¹å¤±è´¥ï¼Œæ£€æŸ¥revisonæ˜¯å¦æ­£ç¡® |
| 95018 | å…·ä½“é”™è¯¯ä¿¡æ¯ | è§£ææ–‡æ¡£å†…å®¹å¤±è´¥ï¼Œè¯¦è§å…·ä½“é”™è¯¯ä¿¡æ¯ |
| 95020 | å…·ä½“é”™è¯¯ä¿¡æ¯ | æ‰¹é‡æ›´æ–°æ–‡æ¡£æ“ä½œå¤±è´¥ï¼Œè¯¦è§å…·ä½“é”™è¯¯ä¿¡æ¯ |
| 95023 | revision too old | ç‰ˆæœ¬å·å¤ªè€ï¼Œè¯·ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬å· |
| 95024 | Failed | å‚æ•°æ— æ•ˆï¼Œæ£€æŸ¥å‚æ•°æœ‰æ•ˆæ€§ |
| 95025 | Failed | è§£æè¯·æ±‚å¤±è´¥ï¼Œæ£€æŸ¥è¯·æ±‚æ˜¯å¦åˆæ³•json |
| 95026 | Failed | æ— æ•ˆçš„batch_update æ“ä½œç±»å‹ï¼Œæ£€æŸ¥batch_updateæ¥å£request_type |
| 95050 | å…·ä½“é”™è¯¯ä¿¡æ¯ | ä¿å­˜æ–‡æ¡£å†…å®¹å¤±è´¥ï¼Œè¯¦è§å…·ä½“é”™è¯¯ä¿¡æ¯ |
| 95053 | this API does not support the Upgraded Docs(docx), please refer to the https://feishu.feishu.cn/docx/ICI7dp1Uioh4EvxXn0HcxUapn0c using the correct API. | æ­¤ API ä¸æ”¯æŒæ–°ç‰ˆæ–‡æ¡£ï¼ˆdocxï¼‰ï¼Œè¯·å‚è€ƒ[æ–°ç‰ˆæ–‡æ¡£ OpenAPI æ¥å…¥æŒ‡å¼•](https://feishu.feishu.cn/docx/ICI7dp1Uioh4EvxXn0HcxUapn0c)ä½¿ç”¨æ­£ç¡®çš„ APIã€‚ |


å…·ä½“å¯å‚è€ƒï¼šæœåŠ¡ç«¯é”™è¯¯ç è¯´æ˜