# æ–‡æ¡£å¸¸è§é—®é¢˜

## 1.  å¦‚ä½•æ’å…¥å¸¦å†…å®¹çš„è¡¨æ ¼ï¼ˆtableï¼‰ï¼Ÿ


- æ–¹å¼ä¸€ï¼šè°ƒç”¨åˆ›å»ºåµŒå¥—å—æ¥å£ï¼Œåœ¨æŒ‡å®šçš„ Parent Block ä¸‹åˆ›å»º Table Blockï¼š

  ```bash
  curl --location --request POST 'https://open.feishu.cn/open-apis/docx/v1/documents/:document_id/blocks/:block_id/descendant?document_revision_id=-1' \
  --header 'Authorization: Bearer u-xxxx' \
  --header 'Content-Type: application/json; charset=utf-8' \
  --data-raw '{
      "index": 0,
      "children_id": [
          "headingid_1",
          "table_id_1"
      ],
      "descendants": [
          {
              "block_id": "headingid_1",
              "block_type": 3,
              "heading1": {
                  "elements": [{"text_run": {"content" : "ç®€å•è¡¨æ ¼"}}]
              },
              "children": []
          },
          {
              "block_id":"table_id_1",
              "block_type": 31,
              "table":{
                  "property" : {
                  "row_size": 1,
                  "column_size" : 2
                  }
              },
              "children": ["table_cell1","table_cell2"]
          },
          {
              "block_id": "table_cell1",
              "block_type": 32,
              "table_cell":{},
              "children": ["table_cell1_child1", "table_cell1_child2"]
          },
          {
              "block_id": "table_cell2",
              "block_type": 32,
              "table_cell":{},
              "children": ["table_cell2_child"]
          },
          {
              "block_id": "table_cell1_child1",
              "block_type": 13,
              "ordered": {
                  "elements": [{"text_run": {"content" : "list 1.1"}}]
              },
              "children": []
          },
          {
              "block_id": "table_cell1_child2",
              "block_type": 13,
              "ordered": {
                  "elements": [{"text_run": {"content" : "list 1.2"}}]
              },
              "children": []
          },
          {
              "block_id": "table_cell2_child",
              "block_type": 2,
              "text": {
                  "elements": [{"text_run": {"content" : ""}}]
              },
              "children": []
          }
      ]
  }'
  # è°ƒç”¨å‰è¯·æ›¿æ¢ 'Authorization: Bearer u-xxx' ä¸­çš„ 'u-xxx' ä¸ºçœŸå®çš„è®¿é—®ä»¤ç‰Œ
  ```
  åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æˆåŠŸåœ°åˆ›å»ºäº†ä¸€ä¸ªä¸€çº§æ ‡é¢˜å—ï¼Œå…¶å†…å®¹ä¸º â€œç®€å•è¡¨æ ¼â€ï¼ŒåŒæ—¶è¿˜åˆ›å»ºäº†ä¸€ä¸ªå¸¦æœ‰å…·ä½“å†…å®¹çš„è¡¨æ ¼å—ã€‚

  å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š


  ![image.png](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/d5b6bfc6c86b2db19a5c49200e812c97_gOGa74B4oH.png?height=310&lazyload=true&width=1670)


- æ–¹å¼äºŒï¼šå…ˆåˆ›å»ºä¸€ä¸ªç©ºè¡¨æ ¼ï¼Œå†å¡«å……å†…å®¹ï¼š

  1. è°ƒç”¨ åˆ›å»ºå— æ¥å£ï¼Œåœ¨æŒ‡å®š Parent Block ä¸‹åˆ›å»ºä¸€ä¸ª Table Blockã€‚
  
  ```bash
  curl --location --request POST '{url}' \
  --header 'Authorization: {Authorization}' \
  --header 'Content-Type: application/json' \
  --data-raw '{
      "index": 0,
      "children": [
          {
              "block_type": 31,
              "table": {
                  "property": {
                      "row_size": 1,
                      "column_size": 1
                  }
              }
          }
      ]
  }'
  ```
  åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª 1 è¡Œ 1 åˆ—çš„è¡¨æ ¼ï¼Œå¦‚æœè°ƒç”¨æˆåŠŸï¼Œé¢„è®¡ä¼šè¿”å›ä¸‹åˆ—æ ¼å¼æ•°æ®ï¼š
  
  ```json
  {
      "code": 0,
      "data": {
          "children": [
              {
                  "block_id": "......",
                  "block_type": 31,
                  "children": [
                      // å•å…ƒæ ¼ BlockID æ•°ç»„ï¼ŒæŒ‰ä»å·¦åˆ°å³ä»ä¸Šåˆ°ä¸‹é¡ºåºæ’åˆ—
                      "......"
                  ],
                  "parent_id": "......",
                  "table": {
                      "cells": [
                          "......"
                      ],
                      "property": {
                          "column_size": 1,
                          "column_width": [
                              100
                          ],
                          "merge_info": [
                              {
                                  "col_span": 1,
                                  "row_span": 1
                              }
                          ],
                          "row_size": 1
                      }
                  }
              }
          ],
          ......
      },
      "msg": ""
  }
  ```
	
    å…¶ä¸­ data.children æ•°ç»„ä¸­å­˜æ”¾äº†æŒ‰ç…§ä»å·¦åˆ°å³ã€ä»ä¸Šåˆ°ä¸‹é¡ºåºéå†å¾—åˆ°çš„å•å…ƒæ ¼ Table Cell çš„ Block IDã€‚æ¥ä¸‹æ¥ï¼Œä½ å¯ç»§ç»­è°ƒç”¨åˆ›å»ºå—æ¥å£ï¼ŒæŒ‡å®š Table Block ä¸º Parent Cellï¼Œå¯¹æŒ‡å®šå•å…ƒæ ¼æ·»åŠ å†…å®¹ã€‚
## 2. å¦‚ä½•æ’å…¥ç”µå­è¡¨æ ¼ï¼ˆsheetï¼‰å¹¶å¾€å•å…ƒæ ¼å¡«å……å†…å®¹ï¼Ÿ

1. è°ƒç”¨ åˆ›å»ºå— æ¥å£ï¼Œåœ¨æŒ‡å®š Parent Block ä¸‹åˆ›å»º Sheet Blockï¼ŒæŒ‡å®šç”µå­è¡¨æ ¼çš„è¡Œæ•°é‡å’Œåˆ—æ•°é‡ã€‚
    ```bash
    curl --location --request POST 'https://{domain}/open-apis/docx/v1/documents/:document_id/blocks/:block_id/children' \
    --header 'Authorization: {Authorization}' \
    --header 'Content-Type: application/json' \
    --data-raw '{
      {
        "index": 0,
        "children": [
          {
            "block_type": 30,
            "sheet": {
              "row_size": 5,
              "column_size": 3
            }
          }
        ]
      }
    }'
    ```	

    åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª 5 è¡Œ 3 åˆ—çš„è¡¨æ ¼ï¼Œå¦‚æœè°ƒç”¨æˆåŠŸï¼Œé¢„è®¡ä¼šè¿”å›ä¸‹åˆ—æ ¼å¼æ•°æ®ã€‚

    ```json
        {
          "code": 0,
          "data": {
            "children": [
              {
                "block_id": "doxcnx8mv0hzeY07TUlKzpabcef",
                "block_type": 30,
                "parent_id": "UFZvdKi97ojvkzx3ZZocklabcef",
                "sheet": {
                  "token": "LxvrsycFwhQYfrt8oYQcwVabcef_QJ6HZR" // ç”µå­è¡¨æ ¼ token + å·¥ä½œè¡¨ ID æ ¼å¼
                }
              }
            ],
            "client_token": "f098d96e-693b-442f-8a7d-82c309ebc500",
            "document_revision_id": 54
          },
          "msg": "success"
        }
    ```

2. è¿”å›çš„ `sheet.token` çš„å€¼ä¸ºç”µå­è¡¨æ ¼çš„ token å’Œç”µå­è¡¨æ ¼å·¥ä½œè¡¨çš„ ID çš„ç»„åˆã€‚ä½ å¯ç»§ç»­è°ƒç”¨ç”µå­è¡¨æ ¼ç›¸å…³æ¥å£ç»§ç»­æ“ä½œè¯¥è¡¨æ ¼ã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºåœ¨è¯¥ç”µå­è¡¨æ ¼ä¸­å†™å…¥æ•°æ®ã€‚
    ```bash
    curl --location --request PUT 'https://open.feishu.cn/open-apis/sheets/v2/spreadsheets/LxvrsycFwhQYfrt8oYQcwVabcef/values' \
    --header 'Authorization: Bearer t-g10474apW3IFUPQGV362IPSAGELJO2SQWL5abcef' \
    --header 'Content-Type: application/json' \
    --data-raw '{
    "valueRange":{
        "range": "QJ6HZR!A1:B2",
        "values": [
          [
            "Hello", 1
          ],
          [
            "World", 1
          ]
        ]
        }
    }'
    ```
    å¦‚æœè°ƒç”¨æˆåŠŸï¼Œé¢„è®¡å°†è¿”å›ä»¥ä¸‹æ•°æ®ï¼š
    ```json
    {
      "code": 0,
      "data": {
        "revision": 2,
        "spreadsheetToken": "LxvrsycFwhQYfrt8oYQcwVabcef",
        "updatedCells": 4,
        "updatedColumns": 2,
        "updatedRange": "QJ6HZR!A1:B2",
        "updatedRows": 2
      },
      "msg": "success"
    }
    ```

## 3. å¦‚ä½•æ’å…¥å›¾ç‰‡ï¼Ÿ

**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå›¾ç‰‡ Block**

è°ƒç”¨ åˆ›å»ºå— æ¥å£ï¼Œåœ¨æŒ‡å®šçš„ Parent Block ä¸‹åˆ›å»º Image Blockï¼š

```bash
curl --location --request POST '{url}' \
--header 'Authorization: {Authorization}' \
--header 'Content-Type: application/json' \
--data-raw '{
  "index": 0,
  "children": [
    {
      "block_type": 27,
      "image": {}
    }
  ]
}'
```

å¦‚æœè°ƒç”¨æˆåŠŸï¼Œé¢„è®¡ä¼šè¿”å›ä¸‹åˆ—æ ¼å¼æ•°æ®ï¼š

```json
{
    "code": 0,
    "data": {
        "children": [
            {
                "block_id": "doxcnEUmKKppwWrnUIcgZ2ibc9g",
                // Image BlockID
                "block_type": 27,
                "image": {
                    "height": 100,
                    "token": "",
                    "width": 100
                },
                "parent_id": "doxcnQxzmNsMl9rsJRZrCpGx71e"
            }
        ],
        "client_token": "bc25a4f0-9a24-4ade-9ca2-6c1db43fa61d",
        "document_revision_id": 7
    },
    "msg": ""
}
```

**ç¬¬äºŒæ­¥ï¼šä¸Šä¼ å›¾ç‰‡ç´ æ**

è°ƒç”¨ ä¸Šä¼ å›¾ç‰‡ç´ æ æ¥å£ï¼Œä½¿ç”¨æ­¥éª¤ä¸€è¿”å›çš„ Image BlockID ä½œä¸º `parent_node` ä¸Šä¼ ç´ æï¼š

```bash
curl --location --request POST '{url}' \
--header 'Authorization: {Authorization}' \
--header 'Content-Type: multipart/form-data; boundary=---7MA4YWxkTrZu0gW' \
--form 'file=@"/tmp/test.PNG"' \ # å›¾ç‰‡æœ¬åœ°è·¯å¾„
--form 'file_name="test.PNG"' \ # å›¾ç‰‡åç§°
--form 'parent_type="docx_image"' \ # ç´ æç±»å‹ä¸º docx_image
--form 'parent_node="doxcnEUmKKppwWrnUIcgZ2ibc9g"' \ # Image BlockID
--form 'size="xxx"' # å›¾ç‰‡å¤§å°
```

å¦‚æœè°ƒç”¨æˆåŠŸï¼Œé¢„è®¡ä¼šè¿”å›ä¸‹åˆ—æ ¼å¼æ•°æ®ï¼š

```json
{
    "code": 0,
    "data": {
        "file_token": "boxbckbfvfcqEg22hAzN8Dh9gJd" // å›¾ç‰‡ç´ æ ID
    },
    "msg": "Success"
}
```

**ç¬¬ä¸‰æ­¥ï¼šè®¾ç½®å›¾ç‰‡ Block çš„ç´ æ**

è°ƒç”¨ æ›´æ–°å— æˆ– æ‰¹é‡æ›´æ–°å— æ¥å£ï¼ŒæŒ‡å®š `replace_image` æ“ä½œï¼Œå°†æ­¥éª¤äºŒè¿”å›çš„å›¾ç‰‡ç´ æ ID è®¾ç½®åˆ°å¯¹åº”çš„ Image Blockï¼Œä»¥æ›´æ–°å—ä¸ºä¾‹ï¼š

``` bash
curl --location --request PATCH '{url}' \
--header 'Authorization: {Authorization}' \
--header 'Content-Type: application/json' \
--data-raw '{
    "replace_image": {
        "token": "boxbckbfvfcqEg22hAzN8Dh9gJd" # å›¾ç‰‡ç´ æ ID
    }
}'
```

## 4. å¦‚ä½•æ’å…¥æ–‡ä»¶/é™„ä»¶ï¼Ÿ

**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªç©ºçš„æ–‡ä»¶ Block**

è°ƒç”¨ åˆ›å»ºå— æ¥å£ï¼Œåœ¨æŒ‡å®š Parent Block ä¸‹åˆ›å»ºä¸€ä¸ªç©ºçš„ File Blockï¼š

```bash
curl --location --request POST '{url}' \
--header 'Authorization: {Authorization}' \
--header 'Content-Type: application/json' \
--data-raw '{
    "index": 0,
    "children": [
        {
            "block_type": 23,
            "file": {
                "token": ""
            }
        }
    ]
}'
```

å¦‚æœè°ƒç”¨æˆåŠŸï¼Œé¢„è®¡ä¼šè¿”å›ä¸‹åˆ—æ ¼å¼æ•°æ®ï¼Œä»ä¸­å¯è·å–åˆ°è¯¥ç©º File Block çš„ ID `doxcn1Bx1WOlcqzLqTD2UUYiA7g`ï¼š

```json
{
    "code": 0,
    "data": {
        "children": [
            {
                "block_id": "doxcnIfCrxq7MlhDbj8xCXmPXgf", // View Block çš„ ID
                "block_type": 33,
                "children": [
                    "doxcn1Bx1WOlcqzLqTD2UUYiA7g" // File Block çš„ ID
                ],
                "parent_id": "doxcnQxzmNsMl9rsJRZrCpGx7ze",
                "view": {
                    "view_type": 1
                }
            }
        ],
        "client_token": "07c56d36-db8b-480f-97f2-7b77a9d3e787",
        "document_revision_id": 8
    },
    "msg": ""
}
```

<md-alert type="tip">
**æ³¨æ„ï¼š** ä¸ Image Block ä¸åŒï¼Œåœ¨åˆ›å»º File Block æˆåŠŸåï¼Œæ¥å£ä¼šè¿”å› View Blockï¼Œè¿™æ˜¯å› ä¸ºæ¯ä¸ª File Block å¯¹åº”éƒ½ä¼šæœ‰ä¸€ä¸ª View Block æ¥æ§åˆ¶å…¶è§†å›¾å½¢å¼ï¼Œå³ View Block æ˜¯ File Block çš„ Parentã€‚
</md-alert>


**ç¬¬äºŒæ­¥ï¼šä¸Šä¼ æ–‡ä»¶ç´ æ**

è°ƒç”¨ä¸Šä¼ ç´ ææ¥å£ï¼Œä½¿ç”¨æ­¥éª¤ä¸€è¿”å›çš„ File Block çš„ ID `doxcn1Bx1WOlcqzLqTD2UUYiA7g` ä½œä¸º `parent_node` çš„å€¼ï¼Œå°†ç´ ææ–‡ä»¶ä¸Šä¼ è‡³è¯¥ File Block ä¸­ï¼š

```bash
curl --location --request POST '{url}' \
--header 'Authorization: {Authorization}' \
--header 'Content-Type: multipart/form-data; boundary=---7MA4YWxkTrZu0gW' \
--form 'file=@"/tmp/test.PNG"' \ # æ–‡ä»¶æœ¬åœ°è·¯å¾„
--form 'file_name="test.PNG"' \ # æ–‡ä»¶åç§°
--form 'parent_type="docx_file"' \ # ç´ æç±»å‹ä¸º docx_file
--form 'parent_node="doxcn1Bx1WOlcqzLqTD2UUYiA7g"' \ # File Block çš„ ID
--form 'size="xxx"' # æ–‡ä»¶å¤§å°
```

å¦‚æœè°ƒç”¨æˆåŠŸï¼Œé¢„è®¡ä¼šè¿”å›ä¸‹åˆ—æ ¼å¼æ•°æ®ï¼Œä»ä¸­å¯è·å–åˆ°å·²æˆåŠŸä¸Šä¼ çš„æ–‡ä»¶çš„ IDï¼š

```json
{
    "code": 0,
    "data": {
        "file_token": "boxbcXvrJyOMX6EhmGF1bkoQwOb" // æ–‡ä»¶ç´ æ ID
    },
    "msg": "Success"
}
```

**ç¬¬ä¸‰æ­¥ï¼šè®¾ç½®æ–‡ä»¶ Block çš„ç´ æ**

è°ƒç”¨ æ›´æ–°å— æˆ– æ‰¹é‡æ›´æ–°å— æ¥å£ï¼ŒæŒ‡å®š `replace_file` æ“ä½œï¼Œå°†æ­¥éª¤äºŒè¿”å›çš„ç´ æ ID è®¾ç½®åˆ°å¯¹åº”çš„ File Blockã€‚ä»¥æ›´æ–°å—ä¸ºä¾‹ï¼š

```bash
## æ³¨æ„ URL ä¸­çš„ block_id è·¯å¾„å‚æ•°éœ€è¦ä¸æ­¥éª¤ä¸€åˆ›å»ºçš„ File Block ID ä¸€è‡´
## https://{domain}/open-apis/docx/v1/documents/:document_id/blocks/doxcn1Bx1WOlcqzLqTD2UUYiA7g

curl --location --request PATCH '{url}' \
--header 'Authorization: {Authorization}' \
--header 'Content-Type: application/json' \
--data-raw '{
    "replace_file": {
        "token": "boxbcXvrJyOMX6EhmGF1bkoQwOb" # æ–‡ä»¶ç´ æ ID
    }
}'
```
## 5. å¦‚ä½•æ’å…¥@ç”¨æˆ· å…ƒç´ ï¼Ÿ

<md-alert type="warn">
é€šè¿‡è°ƒç”¨ OpenAPI æ¥ @ç”¨æˆ·ï¼Œä¸ä¼šå‘è¯¥ç”¨æˆ·å‘é€é€šçŸ¥ã€‚
</md-alert>


@ç”¨æˆ·æ˜¯ Text Block ä¸­çš„ä¸€ä¸ªå†…å®¹å®ä½“ã€‚å¦‚æœè¦ @æŸä¸ªç”¨æˆ·ï¼Œå¯ä»¥è°ƒç”¨ åˆ›å»ºå—æ¥å£ï¼Œåœ¨æŒ‡å®šçˆ¶äº² Block ä¸‹åˆ›å»º Text Blockï¼Œå¹¶åœ¨ Text Block ä¸­æŒ‡å®šè¦ @ çš„ç”¨æˆ· IDï¼š
```json

# https://{domain}/open-apis/docx/v1/documents/:document_id/blocks/:block_id/children?document_revision_id=-1

curl --location --request POST '{url}' \
--header 'Content-Type: application/json' \
--header 'Authorization: {Authorization}' \
--data-raw '{
    "children": [
        {
            "block_type": 2,
            "text": {
                "elements": [
                    {
                        "mention_user": {
                            "text_element_style": {
                                "bold": false,
                                "inline_code": false,
                                "italic": false,
                                "strikethrough": false,
                                "underline": false
                            },
                            "user_id": "{user_id}"
                        }
                    }
                ],
                "style": {
                    "align": 1,
                    "folded": false
                }
            }
        }
    ],
    "index": 0
}'
```
åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œåœ¨`document_id` è¿™ç¯‡æ–‡æ¡£æŒ‡å®šçš„`block_id` ä¸‹ï¼Œåˆ›å»ºäº†ä¸€ä¸ª Child Blockï¼Œè¯¥ Child Block æ˜¯ä¸€ä¸ª Text Blockï¼Œå¹¶ä¸”å…¶ä¸­æœ‰ä¸€ä¸ª`mention_user` çš„æ–‡æœ¬å…ƒç´  @ äº†æŒ‡å®šç”¨æˆ·ï¼Œç”¨æˆ·çš„ ID ä¸º `user_id`ï¼Œå¦‚æœè°ƒç”¨æˆåŠŸï¼Œé¢„è®¡ä¼šè¿”å›ä¸‹åˆ—æ ¼å¼æ•°æ®ï¼š
```json
{
  "code": 0,
  "data": {
    "children": [
      {
        "block_id": "......",
        "block_type": 2,
        "parent_id": "......",
        "text": {
          "elements": [
            {
              "mention_user": {
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                },
                "user_id": "......"
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      }
    ],
    ......
  },
  "msg": "success"
}
```
## 6. å¦‚ä½•æ’å…¥ä¸€ä¸ªå…¬å¼ï¼Ÿ

å…¬å¼ä¸æ˜¯ä¸€ä¸ª Blockï¼Œå…¶æ˜¯ Text Block ä¸‹çš„ä¸€ä¸ª Elementï¼Œç»“æ„ä½“å¦‚ä¸‹ï¼š

```json
{
    "content": string,
    "text_element_style": object(TextElementStyle)
}
```
å¦‚è¦å‘æ–‡æ¡£æ’å…¥ä¸€ä¸ªå…¬å¼ï¼Œå¯è°ƒç”¨åˆ›å»ºå—æ¥å£ï¼Œè¯·æ±‚ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š

```json
{
  "index": 0,
  "children": [
    {
      "block_type": 2,
      "text": {
        "elements": [
          {
            "equation": {
              "content": "1+2=3\n",
              "text_element_style": {
                "bold": false,
                "inline_code": false,
                "italic": false,
                "strikethrough": false,
                "underline": false
              }
            }
          }
        ],
        "style": {
          "align": 1,
          "folded": false
        }
      }
    }
  ]
}
```
## 7. å¦‚ä½•å¾€é«˜äº®å—ï¼ˆCallout Blockï¼‰ä¸­å¡«å……å†…å®¹ï¼Ÿ

è°ƒç”¨ åˆ›å»ºå—æ¥å£ï¼Œå…¶ä¸­è·¯å¾„å‚æ•° `block_id` å¡«å†™ Callout BlockIDï¼Œè¯·æ±‚ä½“ `children` å¡«å……é«˜äº®å—çš„å†…å®¹ã€‚ä¾‹å¦‚ï¼Œåœ¨é«˜äº®å—å†…å®¹çš„ç¬¬ä¸€è¡Œæ’å…¥æ–‡æœ¬å—ï¼š
```json
curl --location --request POST '{url}' \
--header 'Authorization: {Authorization}' \ 
--header 'Content-Type: application/json' \
--data-raw '{
    "index": 0,
    "children": [
        {
            "block_type": 2,
            "text": {
                "elements": [
                    {
                        "text_run": {
                            "content": "å¤šäººå®æ—¶ååŒç¼–è¾‘ï¼Œä¸€åˆ‡å…ƒç´ éƒ½å¯æ’å…¥ã€‚",
                            "text_element_style": {
                                "background_color": 14,
                                "text_color": 5
                            }
                        }
                    },
                    {
                        "text_run": {
                            "content": "ä¸ä»…æ˜¯åœ¨çº¿æ–‡æ¡£ï¼Œæ›´æ˜¯å¼ºå¤§çš„åˆ›ä½œå’Œäº’åŠ¨å·¥å…·ã€‚",
                            "text_element_style": {
                                "background_color": 14,
                                "bold": true,
                                "text_color": 5
                            }
                        }
                    }
                ],
                "style": {}
            }
        }
    ]
}'
```
## 8. å¦‚ä½•æ’å…¥åˆ†æ å—ï¼ˆGrid blockï¼‰å¹¶åœ¨ç¬¬ä¸€æ ä¸­æ’å…¥å†…å®¹ï¼Ÿ

**ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Grid block**

è°ƒç”¨ åˆ›å»ºå— æ¥å£ï¼Œåœ¨æŒ‡å®š Parent block ä¸‹åˆ›å»º Grid blockï¼Œè¯¥ Grid å…±è®¡æœ‰ä¸¤åˆ—ã€‚

**Request**
```bash
# https://{domain}/open-apis/docx/v1/documents/:document_id/blocks/:block_id/children
curl --location --request POST '{url}' \
--header 'Authorization: {Authorization}' \
--header 'Content-Type: application/json' \
--data-raw '{
  "index": 0,
  "children": [
    {
      "block_type": 24,
      "grid": {
        "column_size": 2
      }
    }
  ]
}'
```

**Response**

<md-alert type="tip">
åœ¨åˆ›å»º Grid block æˆåŠŸåï¼Œæ¥å£ä¼šè¿”å› Grid block çš„ `block_id` ä»¥åŠ `children` ç­‰ï¼Œ`children` å³ Grid Column Blockï¼Œç”±äº Request æŒ‡å®šè¦åˆ›å»ºä¸¤åˆ—ï¼Œå› æ­¤ `children` æ•°ç»„ä¸­ä¼šæœ‰ä¸¤ä¸ª`block_id`ï¼Œæ¥ä¸‹æ¥å¯ä»¥ä½¿ç”¨è¿™äº›`block_id`å¾€ Grid Column block ä¸­ç»§ç»­æ·»åŠ  Children blockã€‚
</md-alert>



```bash
{
  "code": 0,
  "data": {
    "children": [
      {
        "block_id": "doxcn7VulseZpcWivDsfNi7tPAf",
        "block_type": 24,
        "children": [
          "doxcnVDmCQuoiQPJUXuaYJnEeBe", // ç¬¬ä¸€ä¸ª Grid Column Block
          "doxcnR4tyA3dJn9MWxa1VrxsKRc"  // ç¬¬äºŒä¸ª Grid Column Block
        ],
        "grid": {
          "column_size": 2
        },
        "parent_id": "Xrt5aEe0DoKTslxIqBRcIEAJnBc"
      }
    ],
    "client_token": "bef26316-0079-4f26-995e-447004dd996a",
    "document_revision_id": 85
  },
  "msg": "success"
}
```

**ç¬¬äºŒæ­¥ï¼šåœ¨ç¬¬ä¸€åˆ— Grid Column Block ä¸­æ’å…¥å†…å®¹**

è°ƒç”¨åˆ›å»ºå—æ¥å£ï¼Œåœ¨æŒ‡å®š Grid Column Block ä¸‹æ’å…¥ä¸€ä¸ªæ–‡æœ¬ Blockã€‚

**Request**

```bash
# https://{domain}/open-apis/docx/v1/documents/:document_id/blocks/:block_id/children
curl --location --request POST '{url}' \
--header 'Authorization: {Authorization}' \
--header 'Content-Type: application/json' \
--data-raw '{
  "index": 0,
  "children": [
    {
      "block_type": 2,
      "text": {
        "elements": [
          {
            "text_run": {
              "content": "å¤šäººå®æ—¶ååŒï¼Œæ’å…¥ä¸€åˆ‡å…ƒç´ ã€‚ä¸ä»…æ˜¯åœ¨çº¿æ–‡æ¡£ï¼Œæ›´æ˜¯å¼ºå¤§çš„åˆ›ä½œå’Œäº’åŠ¨å·¥å…·",
              "text_element_style": {
                "background_color": 14,
                "text_color": 5
              }
            }
          }
        ],
        "style": {}
      }
    }
  ]
}'
```

**Response**

<md-alert type="warn">
åœ¨ç¬¬ä¸€æ­¥åˆ›å»º Grid Block æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¾€æ¯ä¸ª Grid Column Block ä¸‹æ·»åŠ ä¸€ä¸ªç©º Text Blockï¼Œå¦‚æœä¸éœ€è¦é»˜è®¤çš„ç©ºç™½ Text Blockï¼Œå¯ä»¥åœ¨ç¬¬ 2 æ­¥æ·»åŠ å®Œå†…å®¹åï¼Œè‡ªè¡Œåˆ é™¤è¯¥ Text Blockã€‚
</md-alert>


```bash
{
  "code": 0,
  "data": {
    "children": [
      {
        "block_id": "doxcnT2booYsWL6XsAcyl958nye",
        "block_type": 2,
        "parent_id": "doxcnVDmCQuoi1PJUXuTYJnEeBe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "å¤šäººå®æ—¶ååŒï¼Œæ’å…¥ä¸€åˆ‡å…ƒç´ ã€‚ä¸ä»…æ˜¯åœ¨çº¿æ–‡æ¡£ï¼Œæ›´æ˜¯å¼ºå¤§çš„åˆ›ä½œå’Œäº’åŠ¨å·¥å…·",
                "text_element_style": {
                  "background_color": 14,
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "text_color": 5,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      }
    ],
    "client_token": "b09b2539-487b-42f3-b747-f12ab177bb13",
    "document_revision_id": 86
  },
  "msg": "success"
}
```
## 9. å¦‚ä½•è·å–æ–‡æ¡£ä¸­çš„å›¾ç‰‡&é™„ä»¶ï¼Ÿ

1. è°ƒç”¨è·å–æ–‡æ¡£æ‰€æœ‰å—æ¥å£ï¼Œåˆ†é¡µè·å–æ–‡æ¡£æ‰€æœ‰å—çš„å¯Œæ–‡æœ¬å†…å®¹ã€‚
    ```bash
    curl --location 'https://open.feishu.cn/open-apis/docx/v1/documents/:document_id/blocks' \
    --header 'Authorization: {Authorization}'
    ```
    

> **ğŸ“ æ³¨æ„**
> æ­¤æ¥å£ä¸ºåˆ†é¡µæ¥å£ï¼Œå¦‚æœ has_more ä¸º trueï¼Œåˆ™è¡¨ç¤ºä¸‹æ¬¡éå†æ—¶å¯é‡‡ç”¨è¿”å›å€¼ä¸­çš„ page_token æŸ¥è¯¢ä¸‹ä¸€åˆ†é¡µçš„æ–‡æ¡£å†…å®¹ã€‚


åœ¨ä¸Šè¿°ç”¨ä¾‹ä¸­ï¼Œæˆ‘ä»¬è·å–äº†æ–‡æ¡£ç¬¬ä¸€åˆ†é¡µä¸­å—çš„å¯Œæ–‡æœ¬å†…å®¹ï¼Œå¦‚æœè°ƒç”¨æˆåŠŸï¼Œé¢„è®¡ä¼šè¿”å›ä¸‹åˆ—æ ¼å¼æ•°æ®ã€‚
```json
{
    "code": 0,
    "data": {
        "has_more": true,
        "page_token": "aw7DoMKBFMOGwqHCrcO8w6jCmMOvw6ILeADCvsKNw57Di8O5XGV3LG4_w5HCqhFxSnDCrCzCn0BgZcOYUg85EMOYcEAcwqYOw4ojw5QFwofCu8KoIMO3K8Ktw4IuNMOBBHNYw4bCgCV3U1zDu8K-J8KSR8Kgw7Y0fsKZdsKvW3d9w53DnkHDrcO5bDkYwrvDisOEPcOtVFJ-I03CnsOILMOoAmLDknd6dsKqG1bClAjDuS3CvcOTwo7Dg8OrwovDsRdqIcKxw5HDohTDtXN9w5rCkWo",
        "items": [
            {
                "block_id": "AZEUdA02Qo3uuWxjVo7cEyNJnLf",
                "block_type": 1,
                "children": [
                    "MQFydWYYCoEDdpxiq4kcjHZ0noW",
                    "OTZtdNzhFoXOWlxd4BkcKO4on2d"
                ],
                "page": {
                    "elements": [
                        {
                            "text_run": {
                                "content": "ç²¾ç¾å›¾é›†",
                                "text_element_style": {
                                    "bold": false,
                                    "inline_code": false,
                                    "italic": false,
                                    "strikethrough": false,
                                    "underline": false
                                }
                            }
                        }
                    ],
                    "style": {
                        "align": 1
                    }
                },
                "parent_id": ""
            },
            {
                "block_id": "MQFydWYYCoEDdpxiq4kcjHZ0noW",
                "block_type": 27, // block_type: image
                "image": {
                    "align": 2,
                    "height": 1200,
                    "token": "HbuhbbMDBoNf1AxZt0Cc6nR6nSe", // image token
                    "width": 4800
                },
                "parent_id": "AZEUdA02Qo3uuWxjVo7cEyNJnLf"
            },
            {
                "block_id": "OTZtdNzhFoXOWlxd4BkcKO4on2d",
                "block_type": 33, // block_type: view
                "children": [
                    "I90UdpixCo6ZDOxE7dscMWlRn3e"
                ],
                "parent_id": "AZEUdA02Qo3uuWxjVo7cEyNJnLf",
                "view": {
                    "view_type": 1
                }
            },
            {
                "block_id": "I90UdpixCo6ZDOxE7dscMWlRn3e",
                "block_type": 23, // block_type: file
                "file": {
                    "name": "image.png",
                    "token": "KNm7bdTXooqUNAx52ZWcBR0Enib" // file token
                },
                "parent_id": "OTZtdNzhFoXOWlxd4BkcKO4on2d"
            }
        ]
    },
    "msg": "success"
}
```
2. åœ¨è¿”å›æ•°æ®ä¸­ï¼š
    * `"block_type": 27` çš„å—ä¸ºå›¾ç‰‡å—ï¼Œå—ä¸­ `image.token` çš„å€¼ä¸ºå›¾ç‰‡çš„ tokenã€‚
    * `"block_type": 23` çš„å—ä¸ºæ–‡ä»¶å—ï¼Œå—ä¸­ `file.token` çš„å€¼ä¸ºæ–‡ä»¶çš„ tokenã€‚
   
   ä½ å¯åŸºäºå›¾ç‰‡å’Œæ–‡ä»¶çš„ tokenï¼Œè°ƒç”¨ä¸‹è½½ç´ ææ¥å£ä¸‹è½½å¯¹åº”çš„å›¾ç‰‡å’Œæ–‡ä»¶ã€‚
## 10. å¦‚ä½•å°† markdown æ ¼å¼çš„å†…å®¹å†™è¿›é£ä¹¦åœ¨çº¿æ–‡æ¡£ï¼Ÿ

ç›®å‰æ²¡æœ‰æ¥å£æ”¯æŒå°† markdown æ–‡æœ¬å†™å…¥é£ä¹¦åœ¨çº¿æ–‡æ¡£ï¼Œä»…æ”¯æŒå°† markdown æ–‡ä»¶è½¬ä¸ºé£ä¹¦åœ¨çº¿æ–‡æ¡£ï¼Œè¯¦æƒ…å‚è€ƒå¯¼å…¥æ–‡ä»¶æ¦‚è¿°ã€‚

## 11. æœåŠ¡ç«¯ OpenAPI æ¥å£é™é¢‘é˜ˆå€¼æ˜¯å¤šå°‘ï¼Ÿ

å…·ä½“è¯·æŸ¥é˜…å¯¹åº”æ¥å£æ–‡æ¡£ï¼Œæ¯”å¦‚ æ›´æ–°å—çš„å†…å®¹æ¥å£é¢‘ç‡é™åˆ¶ä¸ºæ¯ä¸ªåº”ç”¨ 3 æ¬¡/ç§’ã€‚
## 12. æ–‡æ¡£ OpenAPI æ”¯æŒå“ªäº›ç±»å‹ Blockï¼Ÿ

å…·ä½“è¯·æŸ¥é˜… å—çš„æ•°æ®ç»“æ„ ä¸­ BlockType  å°èŠ‚ã€‚

 ## 13. æ–°åˆ›å»ºçš„æ–‡æ¡£è¿˜æ²¡æœ‰ Blockï¼Œè¯¥å¦‚ä½•æ·»åŠ  Block ï¼Ÿ

æ–°åˆ›å»ºçš„æ–‡æ¡£æœ‰ Blockï¼Œè¯¥ Block ä¸º Page Blockã€‚

åˆ›å»ºç©ºæ–‡æ¡£æˆåŠŸåï¼Œæ¥å£ä¼šè¿”å› `document_id`ï¼Œ`document_id`ä¹Ÿæ˜¯è¯¥æ–‡æ¡£é¡µé¢å—ï¼ˆPage Blockï¼‰çš„ `block_id`ï¼Œå› æ­¤ä½ å¯ä»¥é€šè¿‡æŒ‡å®š `document_id` è°ƒç”¨ åˆ›å»ºå—æ¥å£æ¥æ·»åŠ  Blockã€‚

## 14. è·å–æ–‡æ¡£æ‰€æœ‰å—æ¥å£æ˜¯æŒ‰ä»€ä¹ˆé¡ºåºè¿”å› Block çš„ï¼Ÿ

è·å–æ–‡æ¡£æ‰€æœ‰å—æ¥å£è¿”å›çš„ items æ˜¯ä¸€ä¸ª [1,N] (N>=1) çš„ Block æ•°ç»„ã€‚æ•°ç»„ä¸­å…ƒç´ çš„æ¬¡åºæŒ‰æ–‡æ¡£å†…å®¹å…ˆåºéå†ç»“æœè¿›è¡Œæ’åˆ—ï¼Œå…¶ä¸­ç´¢å¼•ä¸º 0 çš„å…ƒç´ æ˜¯æ–‡æ¡£æ ¹èŠ‚ç‚¹ã€‚

![image.png](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/f2781a250e0532e5d09fed46574eecd0_bnsLLioGHI.png?height=436&lazyload=true&width=1123)

ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œå…¶ Blocks å…ˆåºéå†ç»“æœä¸ºï¼š

![image.png](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/83dda0898d4d82bc4cb8e4b71c7e0544_m1p0yCU21p.png?height=164&lazyload=true&width=923)

 ## 15. å¦‚ä½•æ›´æ–°æ–‡æ¡£æ ‡é¢˜ï¼Ÿ

æ–‡æ¡£ä¸­çš„ Block ä¹‹é—´æ˜¯æ ‘çŠ¶å…³ç³»ï¼Œæ ‘çš„æ ¹ Block æ˜¯ Page Blockï¼Œæ–‡æ¡£æ ‡é¢˜æ˜¯ Page Block çš„æ–‡æœ¬å±æ€§ï¼Œå¹¶ä¸” Page Block çš„ BlockID å°±æ˜¯æ–‡æ¡£çš„ Tokenï¼Œå› æ­¤è‹¥è¦æ›´æ–°æ–‡æ¡£æ ‡é¢˜ï¼Œè¯·è°ƒç”¨ æ›´æ–°å—çš„å†…å®¹æ¥å£ï¼Œå¹¶æŒ‡å®šä¸º `update_text_elements` æˆ– `update_text` æ“ä½œï¼Œå…¶ä¸­è¯·æ±‚çš„è·¯å¾„å‚æ•°ï¼š

- `document_id`ï¼šå¡«å†™æ–°ç‰ˆæ–‡æ¡£çš„ Tokenï¼Œå³ Page Block çš„ BlockID
- `block_id`ï¼šå¡«å†™æ–°ç‰ˆæ–‡æ¡£çš„ Tokenï¼Œå³ Page Block çš„ BlockID
```bash
curl --location --request PATCH '{url}' \
--header 'Content-Type: application/json' \
--header 'Authorization: {Authorization}' \
--data-raw '{
    "update_text_elements": {
        "elements": [
            {
                "text_run": {
                    "content": "New Title" æ–°æ ‡é¢˜
                }
            }
        ]
    }
}'
```
## 16. æ–‡æ¡£æœ‰æœåŠ¡ç«¯çš„ SDK å—ï¼Ÿ

<md-alert type="tip">
SDK çš„å»ºè®¾æ»åäºæœ€æ–°çš„ APIï¼Œæ¯”å¦‚ API å·²æ”¯æŒè¿”å›æŸæ–°ç±»å‹çš„ Blockï¼Œä½† SDK å°šæœªæ”¯æŒè§£æï¼Œä½†ä¼šä¿è¯å…¶å‘å‰å…¼å®¹ã€‚
</md-alert>



ç›®å‰ SDK æ”¯æŒ Javaã€Pythonã€Go å’Œ Node.js è¯­è¨€ï¼š

**Java**

- GitHub ä»£ç æ‰˜ç®¡åœ°å€ï¼š[larksuite/oapi-sdk-java](https://github.com/larksuite/oapi-sdk-java/tree/main/larksuite-oapi/src/main/java/com/larksuite/oapi/service/docx/v1)
- ä½¿ç”¨æŒ‡å¼•ï¼š[GitHub - larksuite/oapi-sdk-java](https://github.com/larksuite/oapi-sdk-java)


**Python**

- GitHub ä»£ç æ‰˜ç®¡åœ°å€ï¼š[larksuite/oapi-sdk-python](https://github.com/larksuite/oapi-sdk-python/tree/main/src/larksuiteoapi/service/docx)
- ä½¿ç”¨æŒ‡å¼•ï¼š[GitHub - larksuite/oapi-sdk-python](https://github.com/larksuite/oapi-sdk-python)

**Go**

- GitHub ä»£ç æ‰˜ç®¡åœ°å€ï¼š[larksuite/oapi-sdk-go](https://github.com/larksuite/oapi-sdk-go/tree/v3_main/service/docx)
- ä½¿ç”¨æŒ‡å¼•ï¼š[GitHub - larksuite/oapi-sdk-go](https://github.com/larksuite/oapi-sdk-go)


**Node.js**

- GitHub ä»£ç æ‰˜ç®¡åœ°å€ï¼š[larksuite/oapi-sdk-node.js](https://github.com/larksuite/node-sdk/blob/main/code-gen/projects/docx.ts)
- ä½¿ç”¨æŒ‡å¼•ï¼š[GitHub - larksuite/oapi-sdk-node.js](https://github.com/larksuite/node-sdk/blob/main/README.zh.md)
## 17. å¦‚ä½•ç›´æ¥é€šè¿‡äº‘æ–‡æ¡£æ¨¡æ¿åˆ›å»ºæ–‡æ¡£ï¼Ÿ

æ¨¡æ¿å…¶å®ä¹Ÿæ˜¯ä¸€ç¯‡æ–‡æ¡£ï¼Œå¯ä»¥é€šè¿‡å…¶é“¾æ¥ä¸­çš„ `document_id` è°ƒç”¨ å¤åˆ¶æ–‡ä»¶ æ¥å£åˆ›å»ºå‡ºä¸€ç¯‡æ–°æ–‡æ¡£ã€‚
å¦‚ä¸‹å›¾ï¼Œå‡å®šã€Œå·¥ä½œå‘¨æŠ¥ã€è¯¥æ¨¡æ¿çš„è®¿é—®é“¾æ¥æ˜¯ `https://{domain}/docx/ke6jdf477ohCVVxzANnc56abcef`ï¼Œé‚£ä¹ˆä½ å¯é€šè¿‡ `ke6jdf477ohCVVxzANnc56abcef` è¿™ä¸ª `document_id` å»å¤åˆ¶æ–‡ä»¶ã€‚

![image.png](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/7a3f03605ba97f77371997814f9c38de_Nty18gpw48.png?height=373&lazyload=true&maxWidth=650&width=1272)

## 18. æ–‡æ¡£ OpenAPI æœ‰å“ªäº›é™åˆ¶?

è¾ƒä¹‹æ—§ç‰ˆæ–‡æ¡£çš„ OpenAPIï¼Œæ–°ç‰ˆ OpenAPI ä¸æ”¯æŒå¸¦å†…å®¹åˆ›å»ºæ–‡æ¡£ã€‚ä¸æ”¯æŒçš„ä¸»è¦åŸå› æ˜¯æ„å»ºåŠç»´æŠ¤æ­£ç¡®çš„åµŒå¥— Block å…³ç³»å¯¹å¼€å‘è€…çš„è¦æ±‚è¾ƒé«˜ã€‚æ¨èä½ ä½¿ç”¨å¯¼å…¥ã€åˆ›å»ºå‰¯æœ¬ç­‰ API æ¥æ»¡è¶³å¸¦å†…å®¹åˆ›å»ºçš„åœºæ™¯ã€‚


## 19. å¦‚ä½•è¯»å–æ–‡æ¡£ä¸­ç”µå­è¡¨æ ¼å—çš„è¯¦ç»†å†…å®¹ï¼Ÿ

1. è°ƒç”¨ è·å–æ–‡æ¡£æ‰€æœ‰å—æ¥å£ï¼Œè·å–ç”µå­è¡¨æ ¼å—çš„ tokenã€‚è‹¥è°ƒç”¨æˆåŠŸï¼Œé¢„è®¡å°†è¿”å›ä»¥ä¸‹æ ¼å¼æ•°æ®ã€‚
  
   å…¶ä¸­è¿”å›çš„ `sheet.token` çš„å€¼ `B3hasMxsshByaEtZxAwcVfWxnSe_Ml1QzO` ä¸ºç”µå­è¡¨æ ¼çš„å”¯ä¸€æ ‡è¯†ï¼ˆspreadsheet_tokenï¼‰å’Œç”µå­è¡¨æ ¼å·¥ä½œè¡¨çš„å”¯ä¸€æ ‡è¯†ï¼ˆsheet_idï¼‰çš„ç»„åˆã€‚
   
    ```json
    {
      "code": 0,
      "data": {
        "has_more": false,
        "items": [
          {
            "block_id": "RMDydlSOLojiUEx0SROcA4fdn5d",
            "block_type": 1,
            "children": [
              "XpvLdPiaxoBM08xhyfEcVZj7nlc"
            ],
            "page": {
              "elements": [
                {
                  "text_run": {
                    "content": "ä¸€ç¯‡æ–‡æ¡£",
                    "text_element_style": {
                      "bold": false,
                      "inline_code": false,
                      "italic": false,
                      "strikethrough": false,
                      "underline": false
                    }
                  }
                }
              ],
              "style": {
                "align": 1
              }
            },
            "parent_id": ""
          },
          {
            "block_id": "XpvLdPiaxoBM08xhyfEcVZj7nlc",
            "block_type": 30,
            "parent_id": "RMDydlSOLojiUEx0SROcA4fdn5d",
            "sheet": {
              "token": "B3hasMxsshByaEtZxAwcVfWxnSe_Ml1QzO"  // ç”µå­è¡¨æ ¼çš„å”¯ä¸€æ ‡è¯†ï¼ˆspreadsheet_tokenï¼‰å’Œç”µå­è¡¨æ ¼å·¥ä½œè¡¨çš„å”¯ä¸€æ ‡è¯†ï¼ˆsheet_idï¼‰çš„ç»„åˆ
            }
          }
        ]
      },
      "msg": "success"
    }
    ```



1. åŸºäºæ­¥éª¤ä¸€è·å–çš„ç”µå­è¡¨æ ¼çš„å”¯ä¸€æ ‡è¯†ï¼ˆspreadsheet_tokenï¼‰å’Œç”µå­è¡¨æ ¼å·¥ä½œè¡¨çš„å”¯ä¸€æ ‡è¯†ï¼ˆsheet_idï¼‰ï¼Œè°ƒç”¨ç”µå­è¡¨æ ¼çš„è¯»å–å•ä¸ªèŒƒå›´æ¥å£ï¼Œè·å–è¡¨æ ¼ä¸­çš„æ•°æ®ã€‚äº†è§£è¯·æ±‚ç¤ºä¾‹å’Œå“åº”ä½“ç¤ºä¾‹è¯·ç›´æ¥å‚è€ƒè¯¥æ¥å£æ–‡æ¡£ã€‚


