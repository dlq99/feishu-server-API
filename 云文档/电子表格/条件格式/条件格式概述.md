# æ¡ä»¶æ ¼å¼æ¦‚è¿°


æ¡ä»¶æ ¼å¼ç”¨äºæ ¹æ®æŒ‡å®šçš„æ¡ä»¶æ›´æ”¹å•å…ƒæ ¼çš„å¤–è§‚æ ¼å¼ã€‚æœ¬æ–‡æ¡£ä»‹ç»ç”µå­è¡¨æ ¼ä¸­æ¡ä»¶æ ¼å¼èƒ½åŠ›çš„ç›¸å…³å‚æ•°å’Œæ–¹æ³•åˆ—è¡¨ã€‚

![](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/d946ddff68a20fbfd3c894ad73ea72fc_Tot8va2lk6.png?height=456&lazyload=true&maxWidth=500&width=799)

## ä½¿ç”¨é™åˆ¶

- å•ä¸ªå·¥ä½œè¡¨ä¸­æœ€å¤šæ”¯æŒè®¾ç½® 20 ä¸ªæ¡ä»¶æ ¼å¼ã€‚
- è°ƒç”¨æ¡ä»¶æ ¼å¼ç›¸å…³æ¥å£æ—¶ï¼Œå•æ¬¡æœ€å¤šæ”¯æŒæ“ä½œ 10 ä¸ªæ¡ä»¶æ ¼å¼ã€‚

## æ¡ä»¶æ ¼å¼å‚æ•°

æœ¬å°èŠ‚ä»‹ç»æ¡ä»¶æ ¼å¼èƒ½åŠ›ä¸­æ¶‰åŠçš„ä¸»è¦å‚æ•°ã€‚

### åº”ç”¨èŒƒå›´ ranges

`ranges` ç”¨äºè®¾ç½®æ¡ä»¶æ ¼å¼çš„åº”ç”¨èŒƒå›´ï¼Œæ”¯æŒä»¥ä¸‹äº”ç§å†™æ³•ã€‚
- sheetIdï¼šå¡«å†™å®é™…çš„å·¥ä½œè¡¨ IDï¼Œè¡¨ç¤ºå°†æ¡ä»¶æ ¼å¼åº”ç”¨äºæ•´è¡¨ã€‚å¦‚ `8fe9d6`ã€‚
- sheetId!{å¼€å§‹è¡Œç´¢å¼•}:{ç»“æŸè¡Œç´¢å¼•}ï¼šå¡«å†™å·¥ä½œè¡¨ ID å’Œè¡Œæ•°åŒºé—´ï¼Œè¡¨ç¤ºå°†æ¡ä»¶æ ¼å¼åº”ç”¨äºæ•´è¡Œã€‚å¦‚ `8fe9d6!1:2`ã€‚
- sheetId!{å¼€å§‹åˆ—ç´¢å¼•}:{ç»“æŸåˆ—ç´¢å¼•}ï¼šå¡«å†™å·¥ä½œè¡¨ ID å’Œåˆ—çš„åŒºé—´ï¼Œè¡¨ç¤ºå°†æ¡ä»¶æ ¼å¼åº”ç”¨äºæ•´åˆ—ã€‚å¦‚`8fe9d6!A:B`ã€‚
- sheetId!{å¼€å§‹å•å…ƒæ ¼}:{ç»“æŸå•å…ƒæ ¼}ï¼šå¡«å†™å·¥ä½œè¡¨ ID å’Œå•å…ƒæ ¼åŒºé—´ï¼Œè¡¨ç¤ºå°†æ¡ä»¶æ ¼å¼åº”ç”¨äºå•å…ƒæ ¼é€‰å®šçš„åŒºåŸŸä¸­ã€‚å¦‚ `8fe9d6!A1:B2`ã€‚
- sheetId!{å¼€å§‹å•å…ƒæ ¼}:{ç»“æŸåˆ—ç´¢å¼•}ï¼šå¡«å†™å·¥ä½œè¡¨ IDã€èµ·å§‹å•å…ƒæ ¼å’Œç»“æŸåˆ—ï¼Œè¡¨ç¤ºçœç•¥ç»“æŸè¡Œï¼Œä½¿ç”¨è¡¨æ ¼çš„æœ€åè¡Œä½œä¸ºç»“æŸè¡Œã€‚å¦‚ `8fe9d6!A1:C`ã€‚

### æ ·å¼ style

æ ·å¼ `style` å‚æ•°ç”¨äºè®¾ç½®æ¡ä»¶æ ¼å¼çš„æ ·å¼ã€‚æ”¯æŒè®¾ç½®å­—ä½“æ ·å¼ã€æ–‡æœ¬è£…é¥°ã€å­—ä½“é¢œè‰²å’ŒèƒŒæ™¯é¢œè‰²ã€‚ç»“æ„å¦‚ä¸‹æ‰€ç¤ºã€‚
```json
{
  "style": {
    "font": {
      "bold": true, // å­—ä½“æ˜¯å¦åŠ ç²—
      "italic": true //  å­—ä½“æ˜¯å¦ä¸ºæ–œä½“
    },
    "fore_color": "#faf1d1", // è®¾ç½®å­—ä½“é¢œè‰²ã€‚éœ€å¡«å†™å­—ä½“é¢œè‰²çš„åå…­è¿›åˆ¶ä»£ç 
    "back_color": "#d9f5d6", // è®¾ç½®èƒŒæ™¯é¢œè‰²ã€‚éœ€å¡«å†™èƒŒæ™¯é¢œè‰²çš„åå…­è¿›åˆ¶ä»£ç 
    "text_decoration": 3 // ä¸ºæ–‡æœ¬è®¾ç½®ä¸‹åˆ’çº¿æˆ–åˆ é™¤çº¿ã€‚0ï¼šæ— ä¸‹åˆ’çº¿å’Œåˆ é™¤çº¿   1ï¼šä¸‹åˆ’çº¿   2ï¼šåˆ é™¤çº¿   3ï¼šåŒæ—¶è®¾ç½®ä¸‹åˆ’çº¿å’Œåˆ é™¤çº¿
  }
}
```

### è§„åˆ™ç±»å‹ rule_type ä¸å±æ€§ attrs

æ¡ä»¶æ ¼å¼çš„ä¸åŒè§„åˆ™ç±»å‹å¯¹å±æ€§å‚æ•° attrs çš„å®šä¹‰ä¸è¦æ±‚ä¸åŒã€‚
å½“ `rule_type` ä¸ºä»¥ä¸‹å››ç§ç±»å‹æ—¶ï¼Œæ— éœ€ä¼ å…¥ `attrs` å‚æ•°ã€‚
- containsBlanksï¼šä¸ºç©º
- notContainsBlanksï¼šä¸ä¸ºç©º
- duplicateValuesï¼šé‡å¤å€¼
- uniqueValuesï¼šå”¯ä¸€å€¼

å½“ `rule_type` ä¸ºä»¥ä¸‹ä¸‰ç§ç±»å‹æ—¶ï¼Œ`attrs` å‚æ•°å®šä¹‰å’Œå–å€¼ä¸åŒï¼Œå…·ä½“å‚è€ƒä¸‹æ–‡ã€‚

- cellIsï¼šé™å®šå€¼èŒƒå›´
- containsTextï¼šåŒ…å«å†…å®¹
- timePeriodï¼šæ—¥æœŸ

#### è§„åˆ™ç±»å‹ä¸º cellIs æ—¶

å½“ `rule_type` ä¸º `cellIs` æ—¶ï¼Œè¡¨ç¤ºåŸºäºå¯¹å€¼èŒƒå›´çš„é™å®šè§„åˆ™ï¼Œåˆ›å»ºæ¡ä»¶æ ¼å¼ã€‚æ­¤æ—¶ï¼Œ`attrs` å‚æ•°ä¸ºæ•°ç»„ï¼Œéœ€ä¼ å…¥ä¸€ç»„ `operator` å’Œ `formula` å‚æ•°ã€‚å…¶ä¸­ï¼Œ`formula` çš„å€¼ä¸ºç”¨æˆ·è‡ªå®šä¹‰ï¼Œ`operator` çš„å¯é€‰å€¼å’Œå¯¹åº”çš„è§„åˆ™å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š



> **ğŸ“ æ³¨æ„**
> formula ä¸º string æ•°ç»„ç±»å‹ã€‚å¡«å†™çš„å€¼è‹¥æ˜¯æ•°å­—ç±»å‹ï¼Œéœ€å¡«å†™ä¸ºå¦‚ `"1"` çš„æ ¼å¼ï¼›è‹¥æ˜¯æ–‡æœ¬ç±»å‹ï¼Œéœ€å¡«å†™ä¸º `"\"aaaaa\""` æ ¼å¼ã€‚å³æ–‡æœ¬éœ€è¦ç”¨ "" åŒ…è£¹å¹¶è½¬ä¹‰ã€‚


<md-dt-table>
<md-dt-thead>
<md-dt-tr>
<md-dt-th style="width: 22%;">operator å–å€¼</md-dt-th>
<md-dt-th style="width: 10%;">formula å–å€¼</md-dt-th>
<md-dt-th style="width: 20%;">è§„åˆ™æè¿°</md-dt-th>
<md-dt-th>attrs å‚æ•°ç¤ºä¾‹</md-dt-th>
</md-dt-tr>
</md-dt-thead>
<md-dt-tbody>
<md-dt-tr level="0">
<md-dt-td>
<md-text type="field-name" >equal
</md-text>
</md-dt-td>
<md-dt-td>
<md-text type="field-type" >ä¸€ä¸ªå…ƒç´ 
</md-text>
</md-dt-td>

<md-dt-td>
ç­‰äº formula ä¸­çš„å…ƒç´ 
</md-dt-td>
<md-dt-td>
```json
{
  "attrs": [
    {
      "operator": "equal",
      "formula": [
        "\"aaaaa\"" // æ–‡æœ¬éœ€è¦ç”¨ "" åŒ…è£¹å¹¶è½¬ä¹‰
      ]
    }
  ]
}
```

</md-dt-td>
</md-dt-tr>

<md-dt-tr level="0">
<md-dt-td>
<md-text type="field-name" >notEqual
</md-text>
</md-dt-td>
<md-dt-td>
<md-text type="field-type" >ä¸€ä¸ªå…ƒç´ 
</md-text>
</md-dt-td>

<md-dt-td>
ä¸ç­‰äº formula ä¸­çš„å…ƒç´ 
</md-dt-td>
<md-dt-td>

```json
{
  "attrs": [
    {
      "operator": "notEqual",
      "formula": [
        "\"aaaaa\"" // æ–‡æœ¬éœ€è¦ç”¨ "" åŒ…è£¹å¹¶è½¬ä¹‰
      ]
    }
  ]
}
```

</md-dt-td>
</md-dt-tr>

<md-dt-tr level="0">
<md-dt-td>
<md-text type="field-name" >greaterThan
</md-text>
</md-dt-td>
<md-dt-td>
<md-text type="field-type" >ä¸€ä¸ªå…ƒç´ 
</md-text>
</md-dt-td>

<md-dt-td>
å¤§äº formula ä¸­çš„å…ƒç´ 
</md-dt-td>
<md-dt-td>
```json
{
  "attrs": [
    {
      "operator": "greaterThan",
      "formula": [
        "100"
      ]
    }
  ]
}
```
</md-dt-td>
</md-dt-tr>

<md-dt-tr level="0">
<md-dt-td>
<md-text type="field-name" >greaterThanOrEqual
</md-text>
</md-dt-td>
<md-dt-td>
<md-text type="field-type" >ä¸€ä¸ªå…ƒç´ 
</md-text>
</md-dt-td>

<md-dt-td>
å¤§äºæˆ–ç­‰äº formula ä¸­çš„å…ƒç´ 
</md-dt-td>
<md-dt-td>
```json
{
  "attrs": [
    {
      "operator": "greaterThanOrEqual",
      "formula": [
        "100"
      ]
    }
  ]
}
```
</md-dt-td>
</md-dt-tr>

<md-dt-tr level="0">
<md-dt-td>
<md-text type="field-name" >lessThan
</md-text>
</md-dt-td>
<md-dt-td>
<md-text type="field-type" >ä¸€ä¸ªå…ƒç´ 
</md-text>
</md-dt-td>

<md-dt-td>
å°äº formula ä¸­çš„å…ƒç´ 
</md-dt-td>
<md-dt-td>
```json
{
  "attrs": [
    {
      "operator": "lessThan",
      "formula": [
        "100"
      ]
    }
  ]
}
```
</md-dt-td>
</md-dt-tr>

<md-dt-tr level="0">
<md-dt-td>
<md-text type="field-name" >lessThanOrEqual
</md-text>
</md-dt-td>
<md-dt-td>
<md-text type="field-type" >ä¸€ä¸ªå…ƒç´ 
</md-text>
</md-dt-td>

<md-dt-td>
å°äºæˆ–ç­‰äº formula ä¸­çš„å…ƒç´ 
</md-dt-td>
<md-dt-td>
```json
{
  "attrs": [
    {
      "operator": "lessThanOrEqual",
      "formula": [
        "100"
      ]
    }
  ]
}
```
</md-dt-td>
</md-dt-tr>

<md-dt-tr level="0">
<md-dt-td>
<md-text type="field-name" >between
</md-text>
</md-dt-td>
<md-dt-td>
<md-text type="field-type" >ä¸¤ä¸ªå…ƒç´ 
</md-text>
</md-dt-td>


<md-dt-td>
ä»‹äº formula ä¸­ä¸¤ä¸ªå…ƒç´ ä¹‹é—´
</md-dt-td>
<md-dt-td>
```json
{
  "attrs": [
    {
      "operator": "between",
      "formula": [
        "100",
        "200"
      ]
    }
  ]
}
```
</md-dt-td>
</md-dt-tr>

<md-dt-tr level="0">
<md-dt-td>
<md-text type="field-name" >notBetween
</md-text>
</md-dt-td>
<md-dt-td>
<md-text type="field-type" >ä¸¤ä¸ªå…ƒç´ 
</md-text>
</md-dt-td>

<md-dt-td>
æœªä»‹äº formula ä¸­ä¸¤ä¸ªå…ƒç´ ä¹‹é—´
</md-dt-td>
<md-dt-td>
```json
{
  "attrs": [
    {
      "operator": "notBetween",
      "formula": [
        "100",
        "200"
      ]
    }
  ]
}
```
</md-dt-td>
</md-dt-tr>
</md-dt-tbody>
</md-dt-table>


ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š
```json
{
  "condition_format": {
    "rule_type": "cellIs",
    "attrs": [
      {
        "operator": "equal",
        "formula": [
              "\"aaaaa\""  // æ–‡æœ¬éœ€è¦ç”¨ "" åŒ…è£¹å¹¶è½¬ä¹‰
        ]
      }
    ]
  },
  "condition_format": {
    "rule_type": "cellIs",
    "attrs": [
      {
        "operator": "between",
        "formula": [   // éœ€è‡ªå®šä¹‰ä¸¤ä¸ªå…ƒç´ ï¼Œè¡¨ç¤ºä»‹äºä¸¤è€…ä¹‹é—´
              "1",
              "10"
        ]
      }
    ]
  }
}
```

#### è§„åˆ™ç±»å‹ä¸º containsText æ—¶

å½“ `rule_type` ä¸º `containsText` æ—¶ï¼Œè¡¨ç¤ºåŸºäºæ–‡æœ¬è§„åˆ™ï¼Œåˆ›å»ºæ¡ä»¶æ ¼å¼ã€‚æ­¤æ—¶ï¼Œ`attrs` å‚æ•°ä¸ºæ•°ç»„ï¼Œéœ€ä¼ å…¥ä¸€ç»„ `operator` å’Œ `text` å‚æ•°ã€‚å…¶ä¸­ï¼Œ`text` çš„å€¼ä¸ºç”¨æˆ·è‡ªå®šä¹‰ï¼Œ`operator` çš„å¯é€‰å€¼å’Œå¯¹åº”çš„è§„åˆ™å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š
| operator å–å€¼  | text å–å€¼ | è§„åˆ™æè¿°         |
| ------------ | ------- | ------------ |
| containsText | ç”¨æˆ·è‡ªå®šä¹‰   | åŒ…å«ä»¥ä¸‹å†…å®¹ï¼šæ–‡æœ¬åŒ…å«  |
| notContains  | ç”¨æˆ·è‡ªå®šä¹‰   | åŒ…å«ä»¥ä¸‹å†…å®¹ï¼šæ–‡æœ¬ä¸åŒ…å« |
| is           | ç”¨æˆ·è‡ªå®šä¹‰   | åŒ…å«ä»¥ä¸‹å†…å®¹ï¼šæ–‡æœ¬ä¸º   |
| beginsWith   | ç”¨æˆ·è‡ªå®šä¹‰   | åŒ…å«ä»¥ä¸‹å†…å®¹ï¼šå¼€å¤´ä¸º   |
| endsWith     | ç”¨æˆ·è‡ªå®šä¹‰   | åŒ…å«ä»¥ä¸‹å†…å®¹ï¼šç»“å°¾ä¸º   |
ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š
```json
{
  "condition_format": {
    "rule_type": "containsText",
    "attrs": [
      {
        "operator": "is",
        "text": "******"
      }
    ]
  }
}
```

#### è§„åˆ™ç±»å‹ä¸º timePeriod æ—¶

å½“ `rule_type` ä¸º `timePeriod` æ—¶ï¼Œè¡¨ç¤ºåŸºäºæ—¥æœŸï¼Œåˆ›å»ºæ¡ä»¶æ ¼å¼ã€‚æ­¤æ—¶ï¼Œ`attrs` å‚æ•°ä¸ºæ•°ç»„ï¼Œä½ éœ€ä¼ å…¥ä¸€ç»„ `operator` å’Œ `time_period` å‚æ•°ã€‚å…¶ä¸­ï¼Œ`operator` ä»…æ”¯æŒ `is` å‚æ•°ï¼Œ`time_period` å‚æ•°çš„å¯é€‰å€¼å’Œå¯¹åº”çš„è§„åˆ™å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š
| operator å–å€¼ | time_period å–å€¼ | è§„åˆ™æè¿°       |
| ----------- | -------------- | ---------- |
| is          | yesterday      | æ—¥æœŸä¸ºï¼šæ˜¨å¤©     |
| is          | today          | æ—¥æœŸä¸ºï¼šä»Šå¤©     |
| is          | tomorrow       | æ—¥æœŸä¸ºï¼šæ˜å¤©     |
| Is          | last7Days      | æ—¥æœŸä¸ºï¼šæœ€è¿‘ 7 å¤© |
ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š
```json
{
  "condition_format": {
    "rule_type": "timePeriod",
    "attrs": [
      {
        "operator": "is",
        "time_period": "today"
      }
    ]
  }
}
```

## æ–¹æ³•åˆ—è¡¨

ä»¥ä¸‹ä¸ºæ¡ä»¶æ ¼å¼çš„æ–¹æ³•åˆ—è¡¨ã€‚å…¶ä¸­ï¼Œâ€œå•†åº—â€ä»£è¡¨åº”ç”¨å•†åº—åº”ç”¨ï¼›â€œè‡ªå»ºâ€ä»£è¡¨ä¼ä¸šè‡ªå»ºåº”ç”¨ï¼Œäº†è§£æ›´å¤šåº”ç”¨ç›¸å…³ä¿¡æ¯ï¼Œå‚è€ƒåº”ç”¨ç±»å‹ç®€ä»‹ã€‚äº†è§£è°ƒç”¨æœåŠ¡ç«¯ API çš„æµç¨‹ï¼Œå‚è€ƒæµç¨‹æ¦‚è¿°ã€‚
:::html
<md-table>
    <md-thead>
<tr>
    <md-th style="width: 35%;"><b>æ–¹æ³• (API)</md-th>
    <md-th style="width: 30%;"><b>æƒé™è¦æ±‚ï¼ˆæ»¡è¶³ä»»ä¸€ï¼‰</md-th>
    <md-th style="width: 20%;"><b>è®¿é—®å‡­è¯</md-th>
    <md-th style="width: 10%;"><b>å•†åº—</md-th>
    <md-th style="width: 10%;"><b>è‡ªå»º</md-th>
</tr>
    </md-thead>
    <md-tbody>
<md-tr>
    <md-td>
`POST` åˆ›å»ºæ¡ä»¶æ ¼å¼ /open-apis/sheets/v2/spreadsheets/:spreadsheetToken/condition_formats/batch_create
    </md-td>
    <md-td>
æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶
æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†ç”µå­è¡¨æ ¼

    </md-td>
    <md-td>
`tenant_access_token`
`user_access_token`
    </md-td>
    <md-td>**âœ“**</md-td>
    <md-td>**âœ“**</md-td>
</md-tr>
<md-tr>
    <md-td>
`POST` æ›´æ–°æ¡ä»¶æ ¼å¼ /open-apis/sheets/v2/spreadsheets/:spreadsheetToken/condition_formats/batch_update
    </md-td>
    <md-td>
æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶
 æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†ç”µå­è¡¨æ ¼
    </md-td>
    <md-td>
`tenant_access_token`
`user_access_token`
    </md-td>
    <md-td>**âœ“**</md-td>
    <md-td>**âœ“**</md-td>
</md-tr>



<md-tr>
    <md-td>
`GET` è·å–æ¡ä»¶æ ¼å¼ /open-apis/sheets/v2/spreadsheets/:spreadsheetToken/condition_formats
    </md-td>
    <md-td>
æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶
æŸ¥çœ‹ã€è¯„è®ºå’Œä¸‹è½½äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶
æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†ç”µå­è¡¨æ ¼
æŸ¥çœ‹ã€è¯„è®ºå’Œå¯¼å‡ºç”µå­è¡¨æ ¼
      
    </md-td>
    <md-td>
`tenant_access_token`
`user_access_token`
    </md-td>
    <md-td>**âœ“**</md-td>
    <md-td>**âœ“**</md-td>
</md-tr>



<md-tr>
    <md-td>
`DELETE` åˆ é™¤æ¡ä»¶æ ¼å¼ /open-apis/sheets/v2/spreadsheets/:spreadsheetToken/condition_formats/batch_delete
    </md-td>
    <md-td>
æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶
 æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†ç”µå­è¡¨æ ¼
    </md-td>
    <md-td>
`tenant_access_token`
`user_access_token`
    </md-td>
    <md-td>**âœ“**</md-td>
    <md-td>**âœ“**</md-td>
</md-tr>




    </md-tbody>
</md-table>