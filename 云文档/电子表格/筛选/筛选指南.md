# ç­›é€‰æŒ‡å—
ç­›é€‰æŒ‡åœ¨ç”µå­è¡¨æ ¼å·¥ä½œè¡¨æŒ‡å®šèŒƒå›´ä¸­ï¼Œä¸ºæŒ‡å®šåˆ—ï¼ˆcolï¼‰è®¾ç½®ç­›é€‰æ¡ä»¶ã€‚æœ¬æ–‡æ¡£ä»‹ç»é£ä¹¦å¼€æ”¾å¹³å°ç”µå­è¡¨æ ¼ä¸­ç­›é€‰èƒ½åŠ›ç›¸å…³çš„å‚æ•°å’Œæ–¹æ³•åˆ—è¡¨ã€‚




> **ğŸ“ æ³¨æ„**
> æœ¬æ–‡æ¡£ä»‹ç»ç”µå­è¡¨æ ¼ç›´æ¥åœ¨å·¥ä½œè¡¨ä¸­åˆ›å»ºã€è·å–ç­›é€‰ç­‰èƒ½åŠ›ã€‚è¦æŸ¥çœ‹åœ¨ç­›é€‰è§†å›¾ä¸­çš„ç­›é€‰æ¡ä»¶è¯´æ˜ï¼Œå‚è€ƒç­›é€‰è§†å›¾çš„ç­›é€‰æ¡ä»¶æŒ‡å—ã€‚


## æ³¨æ„äº‹é¡¹

- ç­›é€‰èŒƒå›´å†…çš„ç¬¬ä¸€è¡Œä¸å‚ä¸ç­›é€‰ã€‚
- å•ä¸ªå·¥ä½œè¡¨æœ€å¤šå¯æŒ‡å®šä¸€ä¸ªç­›é€‰èŒƒå›´ã€‚

## ç­›é€‰å‚æ•°

æœ¬å°èŠ‚ä»‹ç»ç­›é€‰ä¸­æ¶‰åŠçš„ä¸»è¦å‚æ•°åŠå…¶æè¿°ã€‚

### ç­›é€‰èŒƒå›´ range

ç­›é€‰èŒƒå›´ç”¨äºè®¾ç½®ç­›é€‰çš„åº”ç”¨èŒƒå›´ï¼Œä½¿ç”¨ `range` å‚æ•°è¡¨ç¤ºã€‚æ”¯æŒä»¥ä¸‹äº”ç§å†™æ³•ã€‚

| range å†™æ³• | æè¿° | ç¤ºä¾‹ | å›¾ç¤º |
| --- | --- | --- | --- |
| &lt;sheetId&gt; | å¡«å†™å®é™…çš„å·¥ä½œè¡¨ IDï¼Œè¡¨ç¤ºå°†ç­›é€‰åº”ç”¨äºæ•´è¡¨ã€‚ | 0bdf12 | / |
| &lt;sheetId&gt;!&lt;å¼€å§‹è¡Œ&gt;:&lt;ç»“æŸè¡Œ&gt; | å¡«å†™å·¥ä½œè¡¨ ID å’Œè¡Œæ•°åŒºé—´ï¼Œè¡¨ç¤ºå°†ç­›é€‰åº”ç”¨äºæ•´è¡Œã€‚ | 0bdf12!1:2 | ![image.png](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/94218c55f4bdb9c5b9af4a595c449007_W5EaNJW9QA.png?height=323&lazyload=true&maxWidth=222&width=1327) |
| &lt;sheetId&gt;!&lt;å¼€å§‹åˆ—&gt;:&lt;ç»“æŸåˆ—&gt; | å¡«å†™å·¥ä½œè¡¨ ID å’Œåˆ—çš„åŒºé—´ï¼Œè¡¨ç¤ºå°†ç­›é€‰åº”ç”¨äºæ•´åˆ—ã€‚ | 0bdf12!A:B | ![image.png](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/c6a46f088f63e2f4c81dc6bc41811b2c_ZkQTxGQ1m5.png?height=596&lazyload=true&maxWidth=222&width=534) |
| &lt;sheetId&gt;!&lt;å¼€å§‹å•å…ƒæ ¼&gt;:&lt;ç»“æŸå•å…ƒæ ¼&gt; | å¡«å†™å·¥ä½œè¡¨ ID å’Œå•å…ƒæ ¼åŒºé—´ï¼Œè¡¨ç¤ºå°†ç­›é€‰åº”ç”¨äºå•å…ƒæ ¼é€‰å®šçš„åŒºåŸŸä¸­ã€‚ | 0bdf12!A1:B5 | ![image.png](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/76498891d78bff326b0bcffe43427fa9_fUFkCG77Vw.png?height=484&lazyload=true&maxWidth=222&width=722) |
| &lt;sheetId&gt;!&lt;å¼€å§‹å•å…ƒæ ¼&gt;:&lt;ç»“æŸåˆ—&gt; | å¡«å†™å·¥ä½œè¡¨ ID å’Œèµ·å§‹å•å…ƒæ ¼å’Œç»“æŸåˆ—ç´¢å¼•ï¼Œè¡¨ç¤ºå°†ç­›é€‰åº”ç”¨äº ID ä¸º &lt;sheetId&gt; çš„å·¥ä½œè¡¨ä¸­ä»å¼€å§‹å•å…ƒæ ¼æ‰€åœ¨è¡Œåˆ°ç»“æŸè¡Œçš„è¡ŒèŒƒå›´ã€å¼€å§‹å•å…ƒæ ¼æ‰€åœ¨åˆ—åˆ°ç»“æŸåˆ—çš„åˆ—èŒƒå›´åœˆå®šçš„åŒºåŸŸã€‚ | 0bdf12!A2:B | ![image.png](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/f727b1806cd1a5cbe6ceb74ecb6c2ed5_pyYMAKxMfB.png?height=564&lazyload=true&maxWidth=222&width=537) |






### ç­›é€‰æ¡ä»¶ condition

ç­›é€‰æ¡ä»¶ `condition` å‚æ•°ç”¨äºè®¾ç½®ç­›é€‰æ¡ä»¶ï¼Œç»“æ„å¦‚ä¸‹æ‰€ç¤ºã€‚
```jsOn
{
  "filter_type": "number", // ç­›é€‰ç±»å‹ã€‚æšä¸¾å€¼å‚è€ƒä¸‹æ–‡ã€‚
  "compare_type": "less", // æ¯”è¾ƒç±»å‹ã€‚æšä¸¾å€¼ç”± filter_type å†³å®šã€‚å…·ä½“å¯å‚è€ƒä¸‹æ–‡ã€‚
  "expected": [ // ç­›é€‰å€¼ã€‚å…·ä½“å¯å‚è€ƒä¸‹æ–‡ã€‚
    "50%"
  ]
}
```
ç­›é€‰æ¡ä»¶ `condition` ä¸­çš„ç­›é€‰ç±»å‹ `filter_type` å‚æ•°æ”¯æŒä»¥ä¸‹äº”ç§ã€‚æ¯ç§ç­›é€‰ç±»å‹éœ€è¦å¡«å†™å¯¹åº”çš„æ¯”è¾ƒç±»å‹ï¼ˆcompare_typeï¼‰å’Œæ¯”è¾ƒçš„å€¼ï¼ˆexpectedï¼‰ã€‚å…·ä½“è¯´æ˜å¦‚ä¸‹æ‰€ç¤ºã€‚

#### ***å¤šå€¼ç­›é€‰ multiValue***

å¤šå€¼ç­›é€‰æŒ‡ç­›é€‰ç‰¹å®šçš„å€¼ã€‚å½“ç­›é€‰ç±»å‹ä¸ºå¤šå€¼æ—¶ï¼š
- compare_typeï¼šä¸å¡«
- expectedï¼šè¦å±•ç¤ºçš„å€¼ã€‚æ•°ç»„ç±»å‹ï¼Œæ•°ç»„é•¿åº¦éœ€å¤§äº 0 ä¸”å°äºç­‰äºç­›é€‰èŒƒå›´çš„è¡Œæ•°ã€‚æ¯ä¸ªå€¼çš„å­—ç¬¦é•¿åº¦ä¸å¾—è¶…è¿‡ 50,000 ä¸ªã€‚
```json
{
  "condition": {
    "filter_type": "multiValue",
    "expected": ["100", "200", "300"]  // ç­›é€‰å‡ºæ•°æ®ä¸º 100ï¼Œ200, å’Œ 300 çš„å•å…ƒæ ¼
  }
}
```

#### ***æ•°å­—ç­›é€‰ number***

æ•°å­—ç­›é€‰æŒ‡ç­›é€‰ç¬¦åˆç‰¹å®šæ•°å€¼æ¡ä»¶çš„æ•°æ®ã€‚å½“ç­›é€‰ç±»å‹ä¸ºæ•°å­—æ—¶ï¼Œæ¯”è¾ƒç±»å‹ compare_type å‚æ•°çš„æšä¸¾å’Œå¯¹åº”çš„ expected é™åˆ¶å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚
| compare_type æšä¸¾ | æè¿°   | expected æ•°ç»„é•¿åº¦é™åˆ¶ |
| --------------- | ---- | --------------- |
| equal           | ç­‰äº   | 1               |
| notEqual        | ä¸ç­‰äº  | 1               |
| greater         | å¤§äº   | 1               |
| greaterOrEqual  | å¤§äºç­‰äº | 1               |
| less            | å°äº   | 1               |
| lessOrEqual     | å°äºç­‰äº | 1               |
| between         | ä»‹äº   | 2               |
| notBetween      | ä¸ä»‹äº  | 2               |
```json
{
  "condition": {  // ç­›é€‰æ•°å€¼ä¸º 100 çš„å•å…ƒæ ¼
    "filter_type": "number",
    "compare_type": "equal",
    "expected": ["100"]
  },
  "condition": { // ç­›é€‰æ•°å€¼åœ¨ 100 å’Œ 200 ä¹‹é—´çš„å•å…ƒæ ¼ï¼ŒåŒ…æ‹¬ 100 å’Œ 200
    "filter_type": "number",
    "compare_type": "between",
    "expected": ["100", "200"]
  }
}
```

#### ***æ–‡æœ¬ç­›é€‰ text***

æ–‡æœ¬ç­›é€‰æŒ‡ç­›é€‰ç¬¦åˆç‰¹å®šæ–‡æœ¬æ¡ä»¶çš„æ•°æ®ã€‚å½“ç­›é€‰ç±»å‹ä¸ºæ–‡æœ¬æ—¶ï¼š
- expectedï¼šæ–‡æœ¬å­—ç¬¦ã€‚æ•°ç»„ç±»å‹ï¼Œæ•°ç»„é•¿åº¦ä¸º 1ã€‚æ–‡æœ¬å­—ç¬¦çš„é•¿åº¦ä¸å¾—è¶…è¿‡ 1,000ã€‚
- compare_type å‚æ•°çš„æšä¸¾å¦‚ä¸‹æ‰€ç¤ºï¼š

| compare_type æšä¸¾ | æè¿°   |
| --------------- | ---- |
| beginsWith      | å¼€å¤´æ˜¯  |
| notBeginsWith   | å¼€å¤´ä¸æ˜¯ |
| endsWith| ç»“å°¾æ˜¯  |
| notEndsWith     | ç»“å°¾ä¸æ˜¯ |
| contains| åŒ…å«   |
| notContains     | ä¸åŒ…å«  |

```json
{
  "condition": { // ç­›é€‰æ–‡æœ¬æ•°æ®ä¸­åŒ…å«â€œå·²å®Œæˆâ€çš„å•å…ƒæ ¼
    "filter_type": "text",
    "compare_type": "contains",
    "expected": ["å·²å®Œæˆ"]
  }
}
```

#### ***é¢œè‰²ç­›é€‰ color***

é¢œè‰²ç­›é€‰æŒ‡ç­›é€‰å…·æœ‰ç‰¹å®šé¢œè‰²å±æ€§çš„æ•°æ®ã€‚å½“ç­›é€‰ç±»å‹ä¸ºé¢œè‰²æ—¶ï¼š
- expectedï¼šé¢œè‰²çš„åå…­è¿›åˆ¶ä»£ç ï¼Œå¦‚ ["#ffffff"]ã€‚æ•°ç»„ç±»å‹ï¼Œæ•°ç»„é•¿åº¦ä¸º 1ã€‚
- æ¯”è¾ƒç±»å‹ compare_type å‚æ•°çš„æšä¸¾å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚

| compare_type æšä¸¾ | æè¿°    |
| --------------- | ----- |
| backColor       | èƒŒæ™¯é¢œè‰² |
| foreColor       | å­—ä½“é¢œè‰²  |
```json
{
  "condition": { // ç­›é€‰èƒŒæ™¯é¢œè‰²ä¸º #ffffff çš„å•å…ƒæ ¼
    "filter_type": "color",
    "compare_type": "backColor",
    "expected": ["#ffffff"]
  }
}
```

#### æ¸…é™¤æ‰€æœ‰ç­›é€‰ ***clear***

æ¸…é™¤æŸä¸€åˆ—çš„ç­›é€‰æ¡ä»¶ã€‚compare_type å’Œ expected å‡ä¸ç”¨å¡«å†™ã€‚
```json
{
  "condition": { // æ¸…é™¤å½“å‰åˆ—æ‰€æœ‰ç­›é€‰
    "filter_type": "clear",
  }
}
```

## æ–¹æ³•åˆ—è¡¨

ä»¥ä¸‹ä¸ºç­›é€‰çš„æ–¹æ³•åˆ—è¡¨ã€‚å…¶ä¸­ï¼Œâ€œå•†åº—â€ä»£è¡¨åº”ç”¨å•†åº—åº”ç”¨ï¼›â€œè‡ªå»ºâ€ä»£è¡¨ä¼ä¸šè‡ªå»ºåº”ç”¨ï¼Œäº†è§£æ›´å¤šåº”ç”¨ç›¸å…³ä¿¡æ¯ï¼Œå‚è€ƒåº”ç”¨ç±»å‹ç®€ä»‹ã€‚äº†è§£è°ƒç”¨æœåŠ¡ç«¯ API çš„æµç¨‹ï¼Œå‚è€ƒæµç¨‹æ¦‚è¿°ã€‚
| æ–¹æ³• (API) | æƒé™è¦æ±‚ï¼ˆæ»¡è¶³ä»»ä¸€ï¼‰ | è®¿é—®å‡­è¯ | å•†åº— | è‡ªå»º |
| --- | --- | --- | --- | --- |
| `POST` åˆ›å»ºç­›é€‰ /open-apis/sheets/v3/spreadsheets/:spreadsheet_token/sheets/:sheet_id/filter | æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶<br> æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†ç”µå­è¡¨æ ¼ | `tenant_access_token`<br>`user_access_token` | âœ“ | âœ“ |
| `PUT` æ›´æ–°ç­›é€‰ /open-apis/sheets/v3/spreadsheets/:spreadsheet_token/sheets/:sheet_id/filter | æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶<br> æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†ç”µå­è¡¨æ ¼ | `tenant_access_token`<br>`user_access_token` | âœ“ | âœ“ |
| `GET` è·å–ç­›é€‰ /open-apis/sheets/v3/spreadsheets/:spreadsheet_token/sheets/:sheet_id/filter | æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶<br> æŸ¥çœ‹ã€è¯„è®ºå’Œä¸‹è½½äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶<br> æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†ç”µå­è¡¨æ ¼<br> æŸ¥çœ‹ã€è¯„è®ºå’Œå¯¼å‡ºç”µå­è¡¨æ ¼ | `tenant_access_token`<br>`user_access_token` | âœ“ | âœ“ |
| `DELETE` åˆ é™¤ç­›é€‰ /open-apis/sheets/v3/spreadsheets/:spreadsheet_token/sheets/:sheet_id/filter | æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†äº‘ç©ºé—´ä¸­æ‰€æœ‰æ–‡ä»¶<br> æŸ¥çœ‹ã€è¯„è®ºã€ç¼–è¾‘å’Œç®¡ç†ç”µå­è¡¨æ ¼ | `tenant_access_token`<br>`user_access_token` | âœ“ | âœ“ |


