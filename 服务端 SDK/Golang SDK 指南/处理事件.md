# å¤„ç†äº‹ä»¶

é€šè¿‡äº‹ä»¶è®¢é˜…åŠŸèƒ½ï¼Œåº”ç”¨å¯ä»¥åŠæ—¶æ¥æ”¶é£ä¹¦ä¸­èµ„æºæ•°æ®çš„å˜åŒ–ï¼Œå¹¶æ ¹æ®å˜åŒ–æƒ…å†µåšå¯¹åº”çš„ä¸šåŠ¡å¤„ç†ï¼Œè¯¦æƒ…å‚è§äº‹ä»¶æ¦‚è¿°ã€‚åœ¨åº”ç”¨å†…è®¢é˜…äº‹ä»¶æ—¶ï¼Œè¿˜éœ€è¦åœ¨æœ¬åœ°æœåŠ¡ç«¯å»ºç«‹ä¸åº”ç”¨çš„è¿æ¥ï¼Œä»¥ä¾¿æ¥æ”¶äº‹ä»¶æ•°æ®ã€‚æœåŠ¡ç«¯ SDK å°è£…äº†é•¿è¿æ¥æ–¹å¼ï¼Œå¯ä»¥å¿«é€Ÿå»ºç«‹æ•°æ®é€šé“å¤„ç†äº‹ä»¶ï¼›ä½ ä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå»º HTTP æœåŠ¡å™¨å¤„ç†äº‹ä»¶ã€‚ä¸¤ç§æ–¹å¼ä»‹ç»å¦‚ä¸‹ï¼š


| è®¢é˜…æ–¹å¼ | ä»‹ç» |
| --- | --- |
| ä½¿ç”¨é•¿è¿æ¥æ¥æ”¶äº‹ä»¶ | è¯¥æ–¹å¼æ˜¯é£ä¹¦ SDK å†…æä¾›çš„èƒ½åŠ›ï¼Œä½ å¯ä»¥é€šè¿‡é›†æˆé£ä¹¦ SDK ä¸å¼€æ”¾å¹³å°å»ºç«‹ä¸€æ¡ WebSocket å…¨åŒå·¥é€šé“ï¼ˆä½ çš„æœåŠ¡å™¨éœ€è¦èƒ½å¤Ÿè®¿é—®å…¬ç½‘ï¼‰ã€‚åç»­å½“åº”ç”¨è®¢é˜…çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå¼€æ”¾å¹³å°ä¼šé€šè¿‡è¯¥é€šé“å‘ä½ çš„æœåŠ¡å™¨å‘é€æ¶ˆæ¯ã€‚ç›¸è¾ƒäºä¼ ç»Ÿçš„ Webhook æ¨¡å¼ï¼Œé•¿è¿æ¥æ¨¡å¼å¤§å¤§é™ä½äº†æ¥å…¥æˆæœ¬ï¼Œå°†åŸå…ˆ 1 å‘¨å·¦å³çš„å¼€å‘å‘¨æœŸé™ä½åˆ° 5 åˆ†é’Ÿã€‚å…·ä½“ä¼˜åŠ¿å¦‚ä¸‹ï¼šæµ‹è¯•é˜¶æ®µæ— éœ€ä½¿ç”¨å†…ç½‘ç©¿é€å·¥å…·ï¼Œé€šè¿‡é•¿è¿æ¥æ¨¡å¼åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­å³å¯æ¥æ”¶äº‹ä»¶å›è°ƒã€‚SDK å†…å°è£…äº†é‰´æƒé€»è¾‘ï¼Œåªåœ¨å»ºè¿æ—¶è¿›è¡Œé‰´æƒï¼Œåç»­äº‹ä»¶æ¨é€å‡ä¸ºæ˜æ–‡æ•°æ®ï¼Œæ— éœ€å†å¤„ç†è§£å¯†å’ŒéªŒç­¾é€»è¾‘ã€‚åªéœ€ä¿è¯è¿è¡Œç¯å¢ƒå…·å¤‡è®¿é—®å…¬ç½‘èƒ½åŠ›å³å¯ï¼Œæ— éœ€æä¾›å…¬ç½‘ IP æˆ–åŸŸåã€‚æ— éœ€éƒ¨ç½²é˜²ç«å¢™å’Œé…ç½®ç™½åå•ã€‚ |
| å°†äº‹ä»¶å‘é€è‡³å¼€å‘è€…æœåŠ¡å™¨ | ä¼ ç»Ÿçš„ Webhook æ¨¡å¼ï¼Œè¯¥æ–¹å¼éœ€è¦ä½ æä¾›ç”¨äºæ¥æ”¶äº‹ä»¶æ¶ˆæ¯çš„æœåŠ¡å™¨å…¬ç½‘åœ°å€ã€‚åç»­å½“åº”ç”¨è®¢é˜…çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå¼€æ”¾å¹³å°ä¼šå‘æœåŠ¡å™¨çš„å…¬ç½‘åœ°å€å‘é€ HTTP POST è¯·æ±‚ï¼Œè¯·æ±‚å†…åŒ…å«äº‹ä»¶æ•°æ®ã€‚ |


## ï¼ˆæ¨èï¼‰æ–¹å¼ä¸€ï¼šä½¿ç”¨é•¿è¿æ¥æ¥æ”¶äº‹ä»¶

å¦‚æœäº‹ä»¶è®¢é˜…æ–¹å¼éœ€è¦é€‰æ‹© **ä½¿ç”¨é•¿è¿æ¥æ¥æ”¶äº‹ä»¶**ï¼Œåˆ™éœ€è¦å…ˆä½¿ç”¨ SDK å»ºç«‹ä¸åº”ç”¨çš„è¿æ¥ã€‚æœ¬ç« èŠ‚æä¾›å»ºç«‹é•¿è¿æ¥çš„ç¤ºä¾‹ä»£ç ä¸ä»£ç è§£æï¼Œé€šè¿‡ SDK å»ºç«‹é•¿è¿æ¥ä¹‹åï¼Œä½ æ‰èƒ½åœ¨åº”ç”¨çš„äº‹ä»¶è®¢é˜…æ–¹å¼ä¸­ä¿å­˜ **ä½¿ç”¨é•¿è¿æ¥æ¥æ”¶äº‹ä»¶** æ–¹å¼ã€‚å…³äºåº”ç”¨å†…é…ç½®äº‹ä»¶è®¢é˜…æ–¹å¼çš„ä»‹ç»ï¼Œå‚è€ƒé…ç½®äº‹ä»¶è®¢é˜…æ–¹å¼ã€‚

![](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/c5a72c50a0d1caf40bdc8718c911b8cd_MHMSb9cxef.png?height=580&lazyload=true&maxWidth=550&width=1224)

### æ³¨æ„äº‹é¡¹

åœ¨å¼€å§‹é…ç½®ä¹‹å‰ï¼Œä½ éœ€è¦ç¡®ä¿å·²äº†è§£ä»¥ä¸‹æ³¨æ„äº‹é¡¹ï¼š
- ç›®å‰é•¿è¿æ¥æ¨¡å¼ä»…æ”¯æŒä¼ä¸šè‡ªå»ºåº”ç”¨ã€‚
- ä¸ **å°†äº‹ä»¶å‘é€è‡³å¼€å‘è€…æœåŠ¡å™¨** æ–¹å¼ï¼ˆå³è‡ªå»ºæœåŠ¡å™¨æ–¹å¼ï¼‰çš„è¦æ±‚ç›¸åŒï¼Œé•¿è¿æ¥æ¨¡å¼ä¸‹æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œéœ€è¦åœ¨ 3 ç§’å†…å¤„ç†å®Œæˆï¼Œå¦åˆ™ä¼šè§¦å‘è¶…æ—¶é‡æ¨æœºåˆ¶ã€‚
- æ¯ä¸ªåº”ç”¨æœ€å¤šå»ºç«‹ 50 ä¸ªè¿æ¥ï¼ˆåœ¨é…ç½®é•¿è¿æ¥æ—¶ï¼Œæ¯åˆå§‹åŒ–ä¸€ä¸ª client å°±æ˜¯ä¸€ä¸ªè¿æ¥ï¼‰ã€‚
- é•¿è¿æ¥æ¨¡å¼çš„æ¶ˆæ¯æ¨é€ä¸º **é›†ç¾¤æ¨¡å¼**ï¼Œä¸æ”¯æŒå¹¿æ’­ï¼Œå³å¦‚æœåŒä¸€åº”ç”¨éƒ¨ç½²äº†å¤šä¸ªå®¢æˆ·ç«¯ï¼ˆclientï¼‰ï¼Œé‚£ä¹ˆåªæœ‰å…¶ä¸­éšæœºä¸€ä¸ªå®¢æˆ·ç«¯ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚

### é•¿è¿æ¥ä»£ç 

```go
package main
import (
   "context"
   "fmt"
   larkcore "github.com/larksuite/oapi-sdk-go/v3/core"
   larkevent "github.com/larksuite/oapi-sdk-go/v3/event"
   "github.com/larksuite/oapi-sdk-go/v3/event/dispatcher"
   larkim "github.com/larksuite/oapi-sdk-go/v3/service/im/v1"
   larkws "github.com/larksuite/oapi-sdk-go/v3/ws"
)
func main() {
   // æ³¨å†Œäº‹ä»¶å›è°ƒï¼ŒOnP2MessageReceiveV1 ä¸ºæ¥æ”¶æ¶ˆæ¯ v2.0ï¼›OnCustomizedEvent å†…çš„ message ä¸ºæ¥æ”¶æ¶ˆæ¯ v1.0ã€‚
   eventHandler := dispatcher.NewEventDispatcher("", "").
      OnP2MessageReceiveV1(func(ctx context.Context, event *larkim.P2MessageReceiveV1) error {
         fmt.Printf("[ OnP2MessageReceiveV1 access ], data: %s\n", larkcore.Prettify(event))
         return nil
      }).
      OnCustomizedEvent("è¿™é‡Œå¡«å…¥ä½ è¦è‡ªå®šä¹‰è®¢é˜…çš„ event çš„ keyï¼Œä¾‹å¦‚ out_approval", func(ctx context.Context, event *larkevent.EventReq) error {
         fmt.Printf("[ OnCustomizedEvent access ], type: message, data: %s\n", string(event.Body))
         return nil
      })
   // åˆ›å»ºClient
   cli := larkws.NewClient("YOUR_APP_ID", "YOUR_APP_SECRET",
      larkws.WithEventHandler(eventHandler),
      larkws.WithLogLevel(larkcore.LogLevelDebug),
   )
   // å¯åŠ¨å®¢æˆ·ç«¯
   err := cli.Start(context.Background())
   if err != nil {
      panic(err)
   }
}
```

ä»£ç å®ç°è¯´æ˜ï¼š
1. é€šè¿‡ dispatcher.NewEventDispatcher() åˆå§‹åŒ–äº‹ä»¶å¤„ç†å™¨ï¼ˆeventHandlerï¼‰ï¼Œæ³¨æ„**ä¸¤ä¸ªå‚æ•°å¿…é¡»å¡«ç©ºå­—ç¬¦ä¸²**ã€‚
1. é€šè¿‡ eventHandler çš„ OnXXXX() æ–¹æ³•å¤„ç†ä¸åŒçš„äº‹ä»¶ã€‚ä¸Šè¿°ç¤ºä¾‹ä¸­åˆ†åˆ«ç›‘å¬äº†ã€Œæ¥æ”¶æ¶ˆæ¯ v1.0ã€å’Œã€Œæ¥æ”¶æ¶ˆæ¯ v2.0ã€ä¸¤ä¸ªäº‹ä»¶ã€‚
    
    

   **è¯´æ˜**ï¼šå¼€æ”¾å¹³å°æä¾›çš„äº‹ä»¶åŒ…æ‹¬ v1.0 å’Œ v2.0 ä¸¤ä¸ªç‰ˆæœ¬ã€‚ä¸¤ä¸ªç‰ˆæœ¬çš„ç»“æ„ä¸åŒã€‚åœ¨å¤„ç†äº‹ä»¶æ—¶ï¼Œå¯é€šè¿‡äº‹ä»¶åˆ—è¡¨æ–‡æ¡£æˆ–åœ¨å¼€å‘è€…åå°æ·»åŠ äº‹ä»¶æ—¶ï¼Œè·å–äº‹ä»¶çš„ç±»å‹ä¸ç‰ˆæœ¬ä¿¡æ¯ã€‚

   ![](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/4dbc1cd97d95f1af949354ce3c350461_4PX46ts1Hs.png?height=380&lazyload=true&maxWidth=650&width=1666)
   

   å¦‚æœæ˜¯ v1.0 äº‹ä»¶ï¼Œåˆ™æ³¨å†ŒæœåŠ¡å™¨æ—¶éœ€è¦æŸ¥æ‰¾å¹¶ä½¿ç”¨ OnCustomizedEvent æ–¹æ³•ï¼›å¦‚æœæ˜¯ v2.0 äº‹ä»¶ï¼Œåˆ™æ³¨å†ŒæœåŠ¡å™¨æ—¶éœ€è¦æŸ¥æ‰¾å¹¶ä½¿ç”¨ onP2xxxx å¼€å¤´çš„æ–¹æ³•ã€‚
ä¾‹å¦‚ï¼Œä½¿ç”¨ `onP2MessageReceiveV1` æ³¨å†Œæ¥æ”¶æ¶ˆæ¯äº‹ä»¶å›è°ƒæ—¶ï¼Œ`P2`ä¾¿å¯¹åº”çš„æ˜¯ v2.0 ç‰ˆæœ¬äº‹ä»¶ç»“æ„ã€‚

   ![](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/8bbadcadbadcf70bb9cb4c44afea25cd_z7bPrzvx1l.png?height=286&lazyload=true&maxWidth=650&width=1598)
   
1. é€šè¿‡ larkws.NewClient() åˆå§‹åŒ–é•¿è¿æ¥å®¢æˆ·ç«¯ï¼Œå¿…å¡«å‚æ•°ä¸ºåº”ç”¨çš„ APP_ID å’Œ APP_SECRETï¼Œéœ€ç™»å½•[å¼€å‘è€…åå°](https://open.feishu.cn/app)ï¼Œåœ¨åº”ç”¨è¯¦æƒ…é¡µçš„ **å‡­è¯ä¸åŸºç¡€ä¿¡æ¯** > **åº”ç”¨å‡­è¯** åŒºåŸŸè·å–ã€‚
    
    ![](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/f7f89950be7e57c2760a8b5b1f5e17c9_NouE7PqEkQ.png?height=524&lazyload=true&maxWidth=750&width=3594)
1. å¯é€‰å‚æ•°ä¼ å…¥ eventHandlerï¼ŒåŒæ—¶å¯è®¾ç½®æ—¥å¿—çº§åˆ«ã€‚
1. é€šè¿‡ cli.Start() å¯åŠ¨å®¢æˆ·ç«¯ï¼Œå¦‚è¿æ¥æˆåŠŸï¼Œæ§åˆ¶å°ä¼šæ‰“å° "connected to wss://xxxxx"ï¼Œä¸»çº¿ç¨‹å°†é˜»å¡ï¼Œç›´åˆ°è¿›ç¨‹ç»“æŸã€‚
   
   ![](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/b1b3d6b4d3a724fa7408f5c71a11d19e_ysuov6r3Bn.png?height=338&lazyload=true&maxWidth=750&width=2286)

## æ–¹å¼äºŒï¼šå°†äº‹ä»¶å‘é€è‡³å¼€å‘è€…æœåŠ¡å™¨

å¦‚æœäº‹ä»¶è®¢é˜…æ–¹å¼é€‰æ‹© **å°†äº‹ä»¶å‘é€è‡³å¼€å‘è€…æœåŠ¡å™¨**ï¼Œåˆ™éœ€è¦è®¾ç½®äº‹ä»¶è¯·æ±‚åœ°å€ï¼Œåç»­åœ¨äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå¼€æ”¾å¹³å°ä¼šå‘è¯¥åœ°å€å‘é€åŒ…å«äº‹ä»¶ JSON æ•°æ®çš„ HTTP POST è¯·æ±‚ã€‚ä¸ºæ­¤ä½ éœ€å¯åŠ¨ä¸€ä¸ª HTTP æœåŠ¡å™¨æ¥æ”¶å¹¶å¤„ç†äº‹ä»¶ã€‚

![](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/2b355c6bb9405407832987a20a3c1c9b_b94HR233cB.png?height=629&lazyload=true&maxWidth=650&width=962)

### é€‰æ‹©ä¸€ï¼šä½¿ç”¨ Go SDK åŸç”Ÿ HTTP æœåŠ¡å™¨å¤„ç†äº‹ä»¶

è®¢é˜…äº‹ä»¶åï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢ä»£ç ï¼Œå¯¹é£ä¹¦å¼€æ”¾å¹³å°æ¨é€çš„äº‹ä»¶è¿›è¡Œå¤„ç†ã€‚ä»¥ä¸‹ä»£ç ç¤ºä¾‹åŸºäº Go SDK åŸç”Ÿçš„ HTTP æœåŠ¡å™¨ï¼Œå¯åŠ¨ä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼š
```go
package main
import (
    "context"
    "fmt"
    "net/http"
    "github.com/larksuite/oapi-sdk-go/v3/core"
    "github.com/larksuite/oapi-sdk-go/v3/core/httpserverext"
    "github.com/larksuite/oapi-sdk-go/v3/event"
    "github.com/larksuite/oapi-sdk-go/v3/event/dispatcher"
    "github.com/larksuite/oapi-sdk-go/v3/service/im/v1"
)
func main() {
    // æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨
    // ç”¨äºç­¾åéªŒè¯å’Œæ¶ˆæ¯è§£å¯†ï¼Œé»˜è®¤å¯ä»¥ä¼ é€’ä¸ºç©ºä¸²ã€‚ä½†å¦‚æœä½ åœ¨å¼€å‘è€…åå° > äº‹ä»¶ä¸å›è°ƒ > åŠ å¯†ç­–ç•¥ä¸­å¼€å¯äº†åŠ å¯†ï¼Œåˆ™å¿…é¡»ä¼ é€’ Encrypt Key å’Œ Verification Token
    handler := dispatcher.NewEventDispatcher("verificationToken", "eventEncryptKey")
    handler = handler.OnP2MessageReceiveV1(func(ctx context.Context, event *larkim.P2MessageReceiveV1) error {
       // å¤„ç†æ¶ˆæ¯ eventï¼Œè¿™é‡Œç®€å•æ‰“å°æ¶ˆæ¯çš„å†…å®¹
       fmt.Println(larkcore.Prettify(event))
       fmt.Println(event.RequestId())
       return nil
    }).OnCustomizedEvent("è¿™é‡Œå¡«å…¥ä½ è¦è‡ªå®šä¹‰è®¢é˜…çš„ event çš„ keyï¼Œä¾‹å¦‚ out_approval", func(ctx context.Context, event *larkevent.EventReq) error {
       // åŸç”Ÿæ¶ˆæ¯ä½“
       fmt.Println(string(event.Body))
       fmt.Println(larkcore.Prettify(event.Header))
       fmt.Println(larkcore.Prettify(event.RequestURI))
       fmt.Println(event.RequestId())
       // å¤„ç†æ¶ˆæ¯
       cipherEventJsonStr, err := handler.ParseReq(ctx, event)
       if err != nil {
          //  é”™è¯¯å¤„ç†
          return err
       }
       plainEventJsonStr, err := handler.DecryptEvent(ctx, cipherEventJsonStr)
       if err != nil {
          //  é”™è¯¯å¤„ç†
          return err
       }
       // å¤„ç†è§£å¯†åçš„ æ¶ˆæ¯ä½“
       fmt.Println(plainEventJsonStr)
       return nil
    })
    // æ³¨å†Œ http è·¯ç”±
    http.HandleFunc("/webhook/event", httpserverext.NewEventHandlerFunc(handler, larkevent.WithLogLevel(larkcore.LogLevelDebug)))
    // å¯åŠ¨ http æœåŠ¡
    err := http.ListenAndServe(":9999", nil)
    if err != nil {
       panic(err)
    }
}
```
å…¶ä¸­éœ€è¦æ³¨æ„ï¼šEventDispatcher.newBuilder æ–¹æ³•çš„å‚æ•°ç”¨äºç­¾åéªŒè¯å’Œæ¶ˆæ¯è§£å¯†ï¼Œé»˜è®¤å¯ä»¥ä¼ é€’ä¸ºç©ºä¸²ã€‚ä½†å¦‚æœä½ åœ¨[å¼€å‘è€…åå°](https://open.feishu.cn/app)Â > **äº‹ä»¶ä¸å›è°ƒ** > **åŠ å¯†ç­–ç•¥**ä¸­å¼€å¯äº†åŠ å¯†ï¼Œåˆ™å¿…é¡»ä¼ é€’ Encrypt Key å’Œ Verification Tokenã€‚

![](//sf3-cn.feishucdn.com/obj/open-platform-opendoc/529c6adc9193d752eac5f87e4cb0b90e_XaHLy4WSDD.png?height=773&lazyload=true&maxWidth=750&width=1495)

äº†è§£æ›´å¤šäº‹ä»¶è®¢é˜…ç¤ºä¾‹ï¼Œå‚è€ƒ [GitHub ä»£ç ä»“åº“](https://github.com/larksuite/oapi-sdk-go/blob/v3_main/sample/event/event.go)ã€‚

### é€‰æ‹©äºŒï¼šé›†æˆ Gin æ¡†æ¶å¤„ç†äº‹ä»¶

å¦‚æœä½ å½“å‰åº”ç”¨ä½¿ç”¨çš„æ˜¯ Gin Web æ¡†æ¶ï¼Œå¹¶ä¸”ä¸å¸Œæœ›ä½¿ç”¨ Go SDK çš„åŸç”Ÿ HTTP æœåŠ¡å™¨ï¼Œä½ å¯ä»¥å‚è€ƒä»¥ä¸‹é›†æˆæ­¥éª¤ï¼Œå°†å½“å‰åº”ç”¨çš„ Gin æœåŠ¡ä¸ SDK è¿›è¡Œé›†æˆã€‚
1. å®‰è£…é›†æˆåŒ…ã€‚
   
    æŠŠ Go SDK é›†æˆå·²æœ‰çš„ Gin æ¡†æ¶ï¼Œéœ€è¦å…ˆå¼•å…¥ [oapi-sdk-gin](https://github.com/larksuite/oapi-sdk-gin) é›†æˆåŒ…ã€‚
    
      ```bash
      go get -u github.com/larksuite/oapi-sdk-gin
      ```
1. è¿›è¡Œä»£ç é›†æˆã€‚é›†æˆç¤ºä¾‹å¦‚ä¸‹ï¼š
    ```go
    import (
            "context"
            "fmt"

             "github.com/gin-gonic/gin"
             "github.com/larksuite/oapi-sdk-gin"
             "github.com/larksuite/oapi-sdk-go/v3/card"
             "github.com/larksuite/oapi-sdk-go/v3/core"
             "github.com/larksuite/oapi-sdk-go/v3/event/dispatcher"
             "github.com/larksuite/oapi-sdk-go/v3/service/contact/v3"
             "github.com/larksuite/oapi-sdk-go/v3/service/im/v1"
    )

    func main() {
            // æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨
            handler := dispatcher.NewEventDispatcher("verificationToken", "eventEncryptKey").OnP2MessageReceiveV1(func(ctx context.Context, event *larkim.P2MessageReceiveV1) error {
                    fmt.Println(larkcore.Prettify(event))
                    fmt.Println(event.RequestId())
                    return nil
            }).OnP2MessageReadV1(func(ctx context.Context, event *larkim.P2MessageReadV1) error {
                    fmt.Println(larkcore.Prettify(event))
                    fmt.Println(event.RequestId())
                    return nil
            }).OnP2UserCreatedV3(func(ctx context.Context, event *larkcontact.P2UserCreatedV3) error {
                    fmt.Println(larkcore.Prettify(event))
                    fmt.Println(event.RequestId())
                    return nil
            })

            ...

            // åœ¨å·²æœ‰ Gin å®ä¾‹ä¸Šæ³¨å†Œæ¶ˆæ¯å¤„ç†è·¯ç”±
            gin.POST("/webhook/event", sdkginext.NewEventHandlerFunc(handler))
    }
    ```
    
### é€‰æ‹©ä¸‰ï¼šé›†æˆ hertz æ¡†æ¶å¤„ç†äº‹ä»¶

è¯¦æƒ…è¯·å‚è§[é›†æˆ hertz æ¡†æ¶](https://github.com/hertz-contrib/lark-hertz)ã€‚

## ï¼ˆå¯é€‰ï¼‰åœ¨æ¶ˆæ¯å¤„ç†å™¨å†…å‘å¯¹åº”ç”¨æˆ·å‘é€æ¶ˆæ¯

åœ¨ HTTP æœåŠ¡å™¨å¯åŠ¨åï¼Œä½ è¿˜å¯ä»¥è¿›ä¸€æ­¥è¡¥å……ä»£ç é€»è¾‘ï¼Œå®ç°æ¥æ”¶äº‹ä»¶åï¼Œå‘ç”¨æˆ·å‘é€æ¶ˆæ¯çš„æ•ˆæœã€‚


> **ğŸ“ æ³¨æ„**
> å¯¹äºå•†åº—åº”ç”¨çš„ ISV å¼€å‘è€…ï¼Œå½“éœ€è¦åœ¨æ¶ˆæ¯å¤„ç†å™¨å†…å‘å¯¹åº”ä¼ä¸šæˆ–ç»„ç»‡çš„ç”¨æˆ·å‘é€æ¶ˆæ¯æ—¶ï¼Œéœ€è¦å…ˆä»äº‹ä»¶å›è°ƒæ•°æ®ä¸­è·å–ä¼ä¸šæˆ–ç»„ç»‡ keyï¼Œç„¶åä½¿ç”¨å¦‚ä¸‹æ–¹å¼è°ƒç”¨æ¶ˆæ¯ API è¿›è¡Œæ¶ˆæ¯å‘é€ã€‚



```go
import (
        "context"
        "fmt"
        lark "github.com/larksuite/oapi-sdk-go/v3"
        "net/http"
        "os"
        "github.com/larksuite/oapi-sdk-go/v3/core"
        "github.com/larksuite/oapi-sdk-go/v3/core/httpserverext"
        "github.com/larksuite/oapi-sdk-go/v3/event"
        "github.com/larksuite/oapi-sdk-go/v3/event/dispatcher"
        "github.com/larksuite/oapi-sdk-go/v3/service/im/v1"
)
func main() {
        // åˆ›å»º API Clientã€‚ä½ éœ€åœ¨æ­¤ä¼ å…¥ä½ çš„åº”ç”¨çš„å®é™… App ID å’Œ App Secret
        var appID, appSecret = os.Getenv("APP_ID"), os.Getenv("APP_SECRET")
        var cli = lark.NewClient(appID, appSecret, lark.WithLogReqAtDebug(true), lark.WithLogLevel(larkcore.LogLevelDebug))
        // æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨
        handler := dispatcher.NewEventDispatcher("verificationToken", "eventEncryptKey").OnP2MessageReceiveV1(func(ctx context.Context, event *larkim.P2MessageReceiveV1) error {
                // å¤„ç†æ¶ˆæ¯ eventï¼Œè¿™é‡Œç®€å•æ‰“å°æ¶ˆæ¯çš„å†…å®¹
                fmt.Println(larkcore.Prettify(event))
                fmt.Println(event.RequestId())
                // è·å–ä¼ä¸šæˆ–ç»„ç»‡ key å¹¶å‘é€æ¶ˆæ¯
                tenantKey := event.TenantKey()
                // å•†åº—åº”ç”¨ç»™æŒ‡å®šä¼ä¸šæˆ–ç»„ç»‡çš„ç”¨æˆ·å‘é€æ¶ˆæ¯
                resp, err := cli.Im.Message.Create(context.Background(), larkim.NewCreateMessageReqBuilder().
                        ReceiveIdType(larkim.ReceiveIdTypeOpenId).
                        Body(larkim.NewCreateMessageReqBodyBuilder().
                                MsgType(larkim.MsgTypePost).
                                ReceiveId("ou_c245b0a7dff2725cfa2fb104f8babcef").
                                Content("text").
                                Build()).
                        Build(), larkcore.WithTenantKey(tenantKey))
                // å‘é€ç»“æœå¤„ç†ï¼Œresp,err
                fmt.Println(resp, err)
                return nil
        })
        // æ³¨å†Œ http è·¯ç”±
        http.HandleFunc("/webhook/event", httpserverext.NewEventHandlerFunc(handler, larkevent.WithLogLevel(larkcore.LogLevelDebug)))
        // å¯åŠ¨ http æœåŠ¡
        err := http.ListenAndServe(":9999", nil)
        if err != nil {
                panic(err)
        }
}
```

